<?xml version="1.0" encoding="UTF-8"?>
<System AppServerName="" AutoConnectToEdit="T" CalendarTable="ZT070" DatabaseName="jdbc:postgresql://localhost:5432/kaikei01" DatabasePassword="pass" DatabaseUser="postgres" DateFormat="jp11" DriverVMOptions="-Xms128m -Xmx128m" EditorUser="00000" EditorUserPassword="0000000000" ExchangeRateAnnualTable="ZT080" ExchangeRateMonthlyTable="ZT081" FormatVersion="1.1" ImageFileFolder="&lt;CURRENT>\db\image" LoginScript="/////////////////////////////////////#EOL#// 前後日付算出（検索条件初期値用）//#EOL#/////////////////////////////////////#EOL#var today = session.getToday() + '';#EOL#var dateLastWeek = session.getOffsetDate(today, -7, 0);#EOL#var dateNextWeek = session.getOffsetDate(today, 7, 0);#EOL#var date3MonthsAgo = session.getOffsetDate(today, -91, 0);#EOL#var date2MonthsAgo = session.getOffsetDate(today, -61, 0);#EOL#var dateLastMonth = session.getOffsetDate(today, -30, 0);#EOL#var dateNextMonth = session.getOffsetDate(today, 30, 0);#EOL#var dateLastYear = session.getOffsetDate(today, -365, 0);#EOL#var currentFYear = session.getFYearOfDate(today);#EOL##EOL#//////////////////////////#EOL#// セッション属性の登録 //#EOL#//////////////////////////#EOL#session.setAttribute('Today', today);#EOL#session.setAttribute('DateLastWeek', dateLastWeek);#EOL#session.setAttribute('DateNextWeek', dateNextWeek);#EOL#session.setAttribute('Date3MonthsAgo', date3MonthsAgo);#EOL#session.setAttribute('Date2MonthsAgo', date2MonthsAgo);#EOL#session.setAttribute('DateLastMonth', dateLastMonth);#EOL#session.setAttribute('DateNextMonth', dateNextMonth);#EOL#session.setAttribute('DateLastYear', dateLastYear);#EOL#session.setAttribute('CurrentFYear', currentFYear);#EOL#" Name="XEAD会計管理" NumberingTable="ZT030" OutputFolder="" Remarks="Accessで作成されたシステムをXEAD Driverへ移行したサンプルシステムです。#EOL#データベースはPostgreSQL9.2.2で動作確認しました。#EOL##EOL#元ネタは、福森　潤一氏が作成された#EOL#http://www5a.biglobe.ne.jp/~fpeo2/introMS.htm#EOL##EOL#ｋｅｉとおトンのなんでもありのシステム開発奮闘記#EOL#http://www5a.biglobe.ne.jp/~fpeo2/mag2smpl.htm#EOL##EOL#2005/04/11：会計管理プログラム、MyACTv3r6m です。#EOL#accessファイルのダウンロード先、http://www5a.biglobe.ne.jp/~fpeo2/MyACTv3r6m.lzh#EOL##EOL#基本のデータモデルは、渡辺幸三著、業務別データベース設計のためのデータモデリング入門#EOL#第６章　会計管理が元になっています。興味のある方はこちらも参照してください。#EOL##EOL#◆利用条件#EOL#・本データを使用したことによって発生したいかなるトラブル、損害にも、著作者は一切の責任を負いません#EOL#" ScriptFunctions="//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#//http://music.geocities.jp/kreisler_liebesleid/java/JDBC/SwingJDBC2.html#EOL#//Swing JDBC アプリケーション#EOL#//JDBCSwingQuery XEAD Driver Rhino へ書き換え 2012-12-05 SHIMOYAMA Yoshihiro #EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#importPackage(java.awt);#EOL#importPackage(javax.swing);#EOL#importPackage(javax.swing.table);#EOL#importPackage(java.sql);#EOL#importPackage(java.util);#EOL##EOL#////////////////////////#EOL#// JDBCSwingQuery表示 //#EOL#////////////////////////#EOL##EOL#//var obj = new JDBCSwingQuery(strSQL);#EOL##EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL#////////////////////////////////////// S U B R O U T I N E S /////////////////////////////////////////////////#EOL#//////////////////////////////////////////////////////////////////////////////////////////////////////////////#EOL##EOL#/////////////////////////////////#EOL#//        JDBCSwingQuery       //#EOL#/////////////////////////////////#EOL#function JDBCSwingQuery(strsql) {#EOL##EOL#&#x9;var persistMgr;#EOL#&#x9;var f;&#x9;#EOL#&#x9;var model; var table; var scrollpane;#EOL#&#x9;var queryField; var queryButton; var panel; var cont;#EOL#&#x9;var strsql; var rs;#EOL##EOL#&#x9;try {#EOL#&#x9;&#x9;persistMgr = new PersistenceManager();#EOL#&#x9;&#x9;rs = persistMgr.executeSQL(strsql);#EOL#&#x9;&#x9;model = new DataModel(rs);#EOL#&#x9;} catch (e) {#EOL#&#x9;&#x9;JOptionPane.showMessageDialog(null, e);#EOL#&#x9;&#x9;return;#EOL#&#x9;}#EOL##EOL#&#x9;//////////////////////////#EOL#&#x9;// ダイアログ要素の設定 //#EOL#&#x9;//////////////////////////#EOL##EOL#&#x9;f = new JDialog() ;#EOL#&#x9;table = new JTable();#EOL#&#x9;table.setModel(model);#EOL#&#x9;scrollpane = new JScrollPane(table);#EOL##EOL#&#x9;// コンポーネントの作成#EOL#&#x9;queryField = new JTextField(strsql);#EOL#&#x9;queryButton = new JButton(&quot;Submit&quot;);#EOL#&#x9;panel = new JPanel();#EOL#&#x9;panel.setLayout(new GridLayout(2, 1));#EOL#&#x9;panel.add(queryField);#EOL#&#x9;panel.add(queryButton);#EOL##EOL#&#x9;// コンテント・ペインの取得#EOL#&#x9;cont = f.getContentPane();#EOL##EOL#&#x9;// コンテント・ペインに追加#EOL#&#x9;cont.add(panel, BorderLayout.NORTH);#EOL#&#x9;cont.add(scrollpane, BorderLayout.CENTER);#EOL##EOL#&#x9;// JFrame の作成#EOL#&#x9;f.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);#EOL#&#x9;f.setTitle(&quot;JDBCSwingQuery&quot;);#EOL#&#x9;f.pack();#EOL#&#x9;#EOL#&#x9;f.setModal(true); // モーダル指定#EOL#&#x9;f.setVisible(true);#EOL##EOL#&#x9;////////////////////////#EOL#&#x9;// イベント、再クエリ //#EOL#&#x9;////////////////////////#EOL#&#x9;queryButton.addActionListener(function(){#EOL#&#x9;&#x9;strsql = queryField.getText();#EOL#&#x9;&#x9;try {#EOL#&#x9;&#x9;&#x9;rs = persistMgr.executeSQL(strsql);#EOL#&#x9;&#x9;&#x9;model = new DataModel(rs);#EOL#&#x9;&#x9;} catch (e) {#EOL#&#x9;&#x9;&#x9;JOptionPane.showMessageDialog(null, e);#EOL#&#x9;&#x9;&#x9;return;#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;table.setModel(model); #EOL#&#x9;   });#EOL#}#EOL##EOL#/////////////////////////////////#EOL#//      PersistenceManager     //#EOL#/////////////////////////////////#EOL##EOL#function PersistenceManager() {#EOL#&#x9;var conn;#EOL#&#x9;var stmt;#EOL#&#x9;var SQL = &quot;&quot;;#EOL#&#x9;try {#EOL#&#x9;&#x9;// データベースへの接続#EOL##EOL#&#x9;&#x9;    java.lang.Class.forName(&quot;org.postgresql.Driver&quot;);#EOL#&#x9;&#x9;    conn = DriverManager.getConnection(&quot;jdbc:postgresql://localhost:5432/kaikei01&quot;, &quot;postgres&quot;, &quot;pass&quot;);#EOL##EOL#&#x9;&#x9;    stmt = conn.createStatement();#EOL#&#x9;} catch (e) {#EOL#&#x9;&#x9;JOptionPane.showMessageDialog(null, e);#EOL#&#x9;    }#EOL##EOL#&#x9;    this.executeSQL = function(str){#EOL#&#x9;&#x9;try {#EOL#&#x9;&#x9;&#x9;if (stmt.execute(str)) {#EOL#&#x9;&#x9;&#x9;&#x9;// SQL ステートメントの発行#EOL#&#x9;&#x9;&#x9;&#x9;SQL = str;#EOL#&#x9;&#x9;&#x9;&#x9;return stmt.getResultSet();#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;return stmt.executeQuery(SQL);#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;} catch (e) {#EOL#&#x9;&#x9;&#x9;JOptionPane.showMessageDialog(null, e);#EOL#&#x9;&#x9;&#x9;return stmt.executeQuery(SQL);#EOL#&#x9;&#x9;    }#EOL#&#x9;}#EOL##EOL#&#x9;    this.dbClose = function() {#EOL#&#x9;&#x9;  //データベースを切断する#EOL#&#x9;&#x9;  conn.Close();#EOL#&#x9;&#x9;  conn = null;#EOL#&#x9;    }#EOL#}#EOL##EOL#/////////////////////////////////#EOL#//          DataModel          //#EOL#/////////////////////////////////#EOL##EOL#function DataModel(rset) {#EOL#&#x9;var metaData;#EOL#&#x9;var columnNames;#EOL#&#x9;var rows;#EOL#&#x9;var numberOfColumns;#EOL#&#x9;var numberOfRows;#EOL##EOL#&#x9;metaData = rset.getMetaData();&#x9;// ResultSetのメタデータの取得#EOL#&#x9;numberOfColumns =  metaData.getColumnCount();&#x9;// 列数を取得#EOL##EOL#&#x9;columnNames = new Vector();&#x9;// 列名を保持するベクトル#EOL#&#x9;for(column = 0; column &lt; numberOfColumns; column++) {#EOL#&#x9;&#x9; columnNames.addElement(metaData.getColumnLabel(column + 1));&#x9;// 列名を取得#EOL#&#x9;&#x9;//&#x9; javax.swing.JOptionPane.showMessageDialog(null, metaData.getColumnLabel(column + 1));#EOL#&#x9;}#EOL#&#x9;rows = new Vector();&#x9;// ResultSet全体のデータを保持するベクトル#EOL#&#x9;while (rset.next()) {#EOL#&#x9;&#x9;newRow = new Vector();&#x9;// ResultSetの一行分のデータを保持するベクトル#EOL#&#x9;&#x9;for ( i = 1; i &lt;= numberOfColumns; i++) {#EOL#&#x9;&#x9;&#x9;newRow.addElement(rset.getObject(i));&#x9;// 各データを取得し追加#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;rows.addElement(newRow);&#x9;// 各行を追加#EOL#&#x9;}#EOL#&#x9;numberOfRows = rows.size();#EOL#&#x9;//javax.swing.JOptionPane.showMessageDialog(null, numberOfRows + &quot;レコード取得しました。&quot;);#EOL##EOL#&#x9;//TableModelインターフェースとは#EOL#&#x9;//http://www.javadrive.jp/tutorial/jtable/index7.html#EOL#&#x9;//DefaultTableModel(Vector data, Vector columnNames)#EOL#&#x9;//DefaultTableModel を構築し、data と columnNames を setDataVector メソッドに渡すことにより、テーブルを初期化します#EOL#&#x9;model = new DefaultTableModel(rows, columnNames);#EOL#&#x9;return model;#EOL#}#EOL##EOL##EOL#" SessionDetailTable="ZT051" SessionTable="ZT050" SmtpHost="" SmtpPassword="" SmtpPort="" SmtpUser="" TaxTable="ZT060" UserTable="ZT020" UserVariantsTable="ZT040" VariantsTable="ZT010" Version="0.0.1" WelcomePageURL="http://homepage2.nifty.com/dbc/xeadFramework/MenuPage.html">
  <Menu HelpURL="" ID="10" Name="マスター管理メニュー">
    <Option FunctionID="AF010" Index="00" OptionName=""/>
    <Option FunctionID="AF020" Index="01" OptionName=""/>
  </Menu><Menu HelpURL="" ID="20" Name="会計管理メニュー"><Option FunctionID="YF010" Index="00" OptionName=""/><Option FunctionID="YF061" Index="01" OptionName=""/><Option FunctionID="YF080" Index="02" OptionName=""/><Option FunctionID="YF570" Index="10" OptionName=""/><Option FunctionID="YF580" Index="11" OptionName=""/></Menu><Menu HelpURL="" ID="90" Name="システム管理メニュー">
    <Option FunctionID="ZF010" Index="00" OptionName=""/>
    <Option FunctionID="ZF020" Index="01" OptionName=""/>
    <Option FunctionID="ZF030" Index="02" OptionName=""/>
    <Option FunctionID="ZF040" Index="03" OptionName=""/>
    <Option FunctionID="ZF050" Index="05" OptionName=""/>
    <Option FunctionID="ZF060" Index="10" OptionName=""/>
    <Option FunctionID="ZF070" Index="11" OptionName=""/>
    <Option FunctionID="ZF080" Index="12" OptionName=""/>
    <Option FunctionID="ZF082" Index="13" OptionName=""/>
  </Menu><Subsystem ID="A" Name="組織マスター管理" Remarks="門、従業員といった全社的な基本台帳とその管理機能を提供するサブシステム"/><Subsystem ID="Z" Name="システム管理" Remarks="システムへのログインや利用履歴、およびシステム変数等の基本的なシステム設定値を管理するためのサブシステム"/><Subsystem ID="Y" Name="仕訳データ管理" Remarks=""/><Table ActiveWhere="" ID="AT010" Name="部門" RangeKey="" Remarks="部門定義を保持するためのテーブル" SubsystemID="A">
    <Field ID="CDBUMON" Name="部門Ｃ" Nullable="F" Order="0010" Remarks="" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="TXBUMON" Name="部門名" Nullable="F" Order="0020" Remarks="" Size="30" Type="CHAR" TypeOptions="KANJI"/>
    <Field ID="NRKANRISYA" Name="管理者№" Nullable="F" Order="0030" Remarks="" Size="5" Type="CHAR" TypeOptions=""/>
    <Key Fields="CDBUMON" Type="PK"/>
    <Refer Fields="TXKANJI" Order="0" TableAlias="" ToKeyFields="" ToTable="AT020" WithKeyFields="AT010.NRKANRISYA"/>
    <Field ID="TXTEKIYO" Name="摘要" Nullable="T" Order="0040" Remarks="" Size="300" Type="VARCHAR" TypeOptions="KANJI"/>
  </Table><Table ActiveWhere="" ID="AT011" Name="部門階層" RangeKey="" Remarks="組織階層情報を保持するためのテーブル。部門毎に年月期間別の上位部門が定義される。" SubsystemID="A">
    <Field ID="CDBUMON" Name="部門Ｃ" Nullable="F" Order="0" Remarks="" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="DTHAKKOUNENGETSU" Name="発効年月" Nullable="F" Order="1" Remarks="" Size="6" Type="CHAR" TypeOptions="YMONTH"/>
    <Field ID="CDJYOUIBUMON" Name="上位部門Ｃ" Nullable="F" Order="2" Remarks="" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="DTSIKKOUNENGETSU" Name="失効年月" Nullable="F" Order="3" Remarks="" Size="6" Type="CHAR" TypeOptions="YMONTH"/>
    <Key Fields="CDBUMON;DTHAKKOUNENGETSU" Type="PK"/>
    <Refer Fields="TXBUMON" Order="0010" TableAlias="AT010A1" ToKeyFields="" ToTable="AT010" WithKeyFields="AT011.CDBUMON"/>
    <Refer Fields="TXBUMON" Order="0020" TableAlias="AT010A2" ToKeyFields="" ToTable="AT010" WithKeyFields="AT011.CDJYOUIBUMON"/>
    <Script EventP="BC;BU" EventR="BR()" Name="失効年月のエラー検査" Order="0010" Text="if (AT011_DTSIKKOUNENGETSU.value != '' &amp;&amp; AT011_DTSIKKOUNENGETSU.value &lt;=  AT011_DTHAKKOUNENGETSU.value) {#EOL#&#x9;AT011_DTSIKKOUNENGETSU.error = '発効年月より未来に設定してください。'#EOL#}"/>
    <Script EventP="BC;BU" EventR="AR()" Function="" Name="上位部門のエラー検査" Order="0020" Text="importPackage(java.util); // for Class ArrayList //#EOL##EOL#//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rAT011;#EOL#var tougaibumon = ''; //当該部門CD//#EOL#var jyouibumon = '';  //上位部門CD//#EOL#var dthakkounengetsu = ''; //発効年月//#EOL#var dtsikkounengetsu = ''; //失効年月//#EOL#var jyouibumonList = new ArrayList(); //上位部門CDリスト//#EOL#var dthakkounengetsuList = new ArrayList(); //発効年月リスト//#EOL#var dtsikkounengetsuList = new ArrayList(); //失効年月リスト//#EOL##EOL#if (AT011_CDJYOUIBUMON.value != '') {#EOL##EOL#&#x9;////////////////////////////////////////////////////////////////#EOL#&#x9;// '00001'のような値が数値の1として比較されないために明示的に //#EOL#&#x9;// 両辺を文字列化したうえで、部門Ｃと上位部門Ｃとを比較する   //#EOL#&#x9;////////////////////////////////////////////////////////////////#EOL#&#x9;tougaibumon = AT011_CDBUMON.value + '';#EOL#&#x9;jyouibumon = AT011_CDJYOUIBUMON.value + '';#EOL#&#x9;if (tougaibumon == jyouibumon) {#EOL#&#x9;&#x9;AT011_CDJYOUIBUMON.error = '自分自身を上位部門としては指定できません。';#EOL#&#x9;} else {#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;// 階層ループチェック //#EOL#&#x9;&#x9;////////////////////////#EOL#&#x9;&#x9;jyouibumonList.add(jyouibumon);#EOL#&#x9;&#x9;dthakkounengetsuList.add(AT011_DTHAKKOUNENGETSU.value);#EOL#&#x9;&#x9;dtsikkounengetsuList.add(AT011_DTSIKKOUNENGETSU.value);#EOL#&#x9;&#x9;for (var i = 0; i &lt; jyouibumonList.size(); i++) {#EOL#&#x9;&#x9;&#x9;rAT011 = instance.createTableOperator('Select', 'AT011');#EOL#&#x9;&#x9;&#x9;rAT011.addKeyValue('CDBUMON',&#x9;&#x9;&#x9;&#x9;jyouibumonList.get(i));#EOL#&#x9;&#x9;&#x9;rAT011.addKeyValue('DTHAKKOUNENGETSU &lt;',&#x9;dtsikkounengetsuList.get(i));#EOL#&#x9;&#x9;&#x9;rAT011.addKeyValue('DTSIKKOUNENGETSU >',&#x9;dthakkounengetsuList.get(i));#EOL#&#x9;&#x9;&#x9;while(rAT011.next()) {#EOL#&#x9;&#x9;&#x9;&#x9;jyouibumon = rAT011.getValueOf('CDJYOUIBUMON') + '';#EOL#&#x9;&#x9;&#x9;&#x9;dthakkounengetsu = rAT011.getValueOf('DTHAKKOUNENGETSU');#EOL#&#x9;&#x9;&#x9;&#x9;dtsikkounengetsu = rAT011.getValueOf('DTSIKKOUNENGETSU');#EOL#&#x9;&#x9;&#x9;&#x9;if (jyouibumon == tougaibumon) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;AT011_CDJYOUIBUMON.error = '指定の部門が階層上でループします。';#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;i = jyouibumonList.size();#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;break;#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;jyouibumonList.add(jyouibumon);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dthakkounengetsuList.add(dthakkounengetsu);#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;dtsikkounengetsuList.add(dtsikkounengetsu);#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#}"/>
    <Script EventP="BC" EventR="BR()" Function="" Name="追加時初期設定" Order="0030" Text="if (AT011_DTHAKKOUNENGETSU.value == '') {#EOL#&#x9;AT011_DTHAKKOUNENGETSU.value = session.getThisMonth() + '';#EOL#}#EOL#if (AT011_DTSIKKOUNENGETSU.value == '') {#EOL#&#x9;AT011_DTSIKKOUNENGETSU.value = '999912';#EOL#}"/>
  </Table><Table ActiveWhere="" ID="AT020" Name="従業員" RangeKey="" Remarks="従業員情報を保持するためのテーブル" SubsystemID="A">
    <Field ID="NRJYUGYOIN" Name="従業員№" Nullable="F" Order="0" Remarks="" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="TXKANA" Name="カナ名" Nullable="F" Order="1" Remarks="" Size="30" Type="CHAR" TypeOptions="KATAKANA"/>
    <Field ID="TXKANJI" Name="漢字名" Nullable="F" Order="2" Remarks="" Size="30" Type="CHAR" TypeOptions="KANJI"/>
    <Field ID="KBKOYOU" Name="雇用区分" Nullable="F" Order="3" Remarks="" Size="5" Type="CHAR" TypeOptions="KUBUN(KBKOYOU)"/>
    <Field ID="DTNYUSYA" Name="入社日" Nullable="F" Order="4" Remarks="" Size="10" Type="DATE" TypeOptions=""/>
    <Field ID="DTTAISYA" Name="退社日" Nullable="T" Order="5" Remarks="" Size="10" Type="DATE" TypeOptions=""/>
    <Key Fields="NRJYUGYOIN" Type="PK"/>
  </Table><Table ActiveWhere="" ID="AT021" Name="従業員所属部門" RangeKey="DTSYOZOKUNENGETSU;DTSIKKONENGETSU" Remarks="従業員の所属部門を保持するためのテーブル。従業員毎に年月期間別の所属部門が定義される。" SubsystemID="A">
    <Field ID="NRJYUGYOIN" Name="従業員№" Nullable="F" Order="0010" Remarks="" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="DTSYOZOKUNENGETSU" Name="所属発効年月" Nullable="F" Order="0020" Remarks="" Size="6" Type="CHAR" TypeOptions="YMONTH"/>
    <Field ID="CDBUMON" Name="部門Ｃ" Nullable="F" Order="0030" Remarks="" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="DTSIKKONENGETSU" Name="所属失効年月" Nullable="T" Order="0040" Remarks="" Size="6" Type="CHAR" TypeOptions="YMONTH,VIRTUAL"/>
    <Key Fields="NRJYUGYOIN;DTSYOZOKUNENGETSU" Type="PK"/>
    <Refer Fields="TXKANJI" Order="0" TableAlias="" ToKeyFields="" ToTable="AT020" WithKeyFields="AT021.NRJYUGYOIN"/>
    <Refer Fields="TXBUMON" Order="1" TableAlias="" ToKeyFields="" ToTable="AT010" WithKeyFields="AT021.CDBUMON"/>
  </Table><Table ActiveWhere="" ID="ZT070" Name="休日テーブル" RangeKey="" Remarks="公休日や会社の特別休日の情報を保持するためのテーブル。日付選択用カレンダーの休日表示設定のために利用される。" SubsystemID="Z">
    <Field ID="DTOFF" Name="休日日付" Nullable="F" Order="0" Size="10" Type="DATE" TypeOptions=""/>
    <Field ID="TXOFF" Name="摘要" Nullable="T" Order="1" Size="20" Type="CHAR" TypeOptions="KANJI"/>
    <Key Fields="DTOFF" Type="PK"/>
  </Table><Table ActiveWhere="" ID="ZT040" Name="ユーザ定義区分" RangeKey="" Remarks="キー値と摘要の組み合わせで定義できる区分情報を保持するためのテーブル" SubsystemID="Z">
    <Field ID="IDUSERKUBUN" Name="区分ＩＤ" Nullable="F" Order="0" Size="20" Type="CHAR" TypeOptions=""/>
    <Field ID="KBUSERKUBUN" Name="区分値" Nullable="F" Order="1" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="TXUSERKUBUN" Name="区分値摘要" Nullable="F" Order="2" Size="20" Type="CHAR" TypeOptions="KANJI"/>
    <Field ID="SQLIST" Name="一覧順序" Nullable="F" Order="3" Size="2" Type="CHAR" TypeOptions=""/>
    <Key Fields="IDUSERKUBUN;KBUSERKUBUN" Type="PK"/>
  </Table><Table ActiveWhere="" ID="ZT020" Name="ユーザ" RangeKey="" Remarks="ユーザ定義を保持するためのテーブル。ユーザは必ずしも従業員と関連されている必要はない。" SubsystemID="Z">
    <Field ID="IDUSER" Name="ユーザＩＤ" Nullable="F" Order="0010" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="TXPASSWORD" Name="パスワード" Nullable="F" Order="0030" Size="32" Type="CHAR" TypeOptions=""/>
    <Field ID="DTVALID" Name="発効日" Nullable="F" Order="0040" Size="10" Type="DATE" TypeOptions=""/>
    <Field ID="DTEXPIRE" Name="失効日" Nullable="F" Order="0050" Size="10" Type="DATE" TypeOptions=""/>
    <Field ID="TXMENUS" Name="利用可能メニュー" Nullable="F" Order="0070" Size="30" Type="CHAR" TypeOptions=""/>
    <Key Fields="IDUSER" Type="PK"/>
    <Script EventP="BC;BU" EventR="BR()" Name="失効日のエラー検査" Order="0" Text="if (ZT020_DTEXPIRE.value != '' &amp;&amp; ZT020_DTEXPIRE.value &lt;=  ZT020_DTVALID.value) {#EOL# ZT020_DTEXPIRE.error = '発効日より未来に設定してください。'#EOL#}"/>
    <Field ID="NREMPLOYEE" Name="従業員№" Nullable="T" Order="0080" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="TXNAME" Name="ユーザ名" Nullable="F" Order="0020" Size="30" Type="CHAR" TypeOptions="KANJI"/>
    <Refer Fields="" Order="0010" TableAlias="" ToKeyFields="NRJYUGYOIN" ToTable="AT020" WithKeyFields="ZT020.NREMPLOYEE"/>
    <Script EventP="BC;BU" EventR="BR()" Function="" Name="パスワードの初期化" Order="0010" Text="if (ZT020_TXPASSWORD.value == '') {#EOL#&#x9;ZT020_TXPASSWORD.value = 'f1b708bba17f1ce948dc979f4d7092bc' //&quot;0000000000&quot;のハッシュコード値//#EOL#}"/>
    <Field ID="TXEMAIL" Name="メールアドレス" Nullable="T" Order="0060" Size="40" Type="CHAR" TypeOptions=""/>
  </Table><Table ActiveWhere="" ID="ZT051" Name="セッション明細" RangeKey="" Remarks="セッション毎の機能の利用履歴を保持するためのテーブル" SubsystemID="Z">
    <Field ID="NRSESSION" Name="セッション№" Nullable="F" Order="0" Size="7" Type="CHAR" TypeOptions=""/>
    <Field ID="SQPROGRAM" Name="行番" Nullable="F" Order="1" Size="4" Type="SMALLINT" TypeOptions=""/>
    <Field ID="IDMENU" Name="メニューID" Nullable="F" Order="2" Size="2" Type="CHAR" TypeOptions=""/>
    <Field ID="IDPROGRAM" Name="プログラムID" Nullable="F" Order="3" Size="10" Type="CHAR" TypeOptions=""/>
    <Field ID="TXPROGRAM" Name="プログラム名" Nullable="F" Order="4" Size="30" Type="CHAR" TypeOptions=""/>
    <Field ID="DTSTART" Name="利用開始日時" Nullable="F" Order="5" Size="26" Type="TIMESTAMP" TypeOptions=""/>
    <Field ID="DTEND" Name="利用終了日時" Nullable="T" Order="6" Size="26" Type="TIMESTAMP" TypeOptions=""/>
    <Field ID="KBPROGRAMSTATUS" Name="終了状態" Nullable="T" Order="7" Size="2" Type="CHAR" TypeOptions=""/>
    <Field ID="TXERRORLOG" Name="処理ログ" Nullable="T" Order="8" Size="3" Type="LONG VARCHAR" TypeOptions=""/>
    <Key Fields="NRSESSION;SQPROGRAM" Type="PK"/>
    <Refer Fields="IDUSER" Order="0" TableAlias="" ToKeyFields="" ToTable="ZT050" WithKeyFields="ZT051.NRSESSION"/>
    <Refer Fields="TXNAME" Order="1" TableAlias="" ToKeyFields="" ToTable="ZT020" WithKeyFields="ZT050.IDUSER"/>
    <Script EventP="BC;BU;BD;AR" EventR="AR()" Name="終了状態にもとづく配色設定" Order="0" Text="if (ZT051_KBPROGRAMSTATUS.value == '99') {#EOL#  ZT051_KBPROGRAMSTATUS.color = 'red';#EOL#}"/>
  </Table><Table ActiveWhere="" ID="ZT060" Name="消費税率" RangeKey="" Remarks="開始日別の消費税率を保持するためのテーブル" SubsystemID="Z">
    <Field ID="DTSTART" Name="開始日" Nullable="F" Order="0" Size="10" Type="DATE" TypeOptions=""/>
    <Field Decimal="2" ID="VLTAXRATE" Name="税率" Nullable="F" Order="1" Size="3" Type="NUMERIC" TypeOptions=""/>
    <Key Fields="DTSTART" Type="PK"/>
    <Script EventP="BC;BU" EventR="BR()" Name="消費税率のエラー検査" Order="0" Text="if (ZT060_VLTAXRATE.value >= 1.00) {#EOL# ZT060_VLTAXRATE.error = '1.00より小さい値を設定してください。'#EOL#}"/>
  </Table><Table ActiveWhere="" ID="ZT030" Name="採番テーブル" RangeKey="" Remarks="キーフィールド（レコード識別用フィールド）の自動採番を管理するためのテーブル" SubsystemID="Z">
    <Field ID="IDNUMBER" Name="番号ＩＤ" Nullable="F" Order="0" Size="20" Type="CHAR" TypeOptions=""/>
    <Field ID="TXPREFIX" Name="冒頭文字" Nullable="T" Order="1" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="0" ID="NRNUMDIGIT" Name="数字部桁" Nullable="F" Order="2" Size="2" Type="NUMERIC" TypeOptions=""/>
    <Field ID="NRCURRENT" Name="現在番号値" Nullable="F" Order="3" Size="9" Type="INTEGER" TypeOptions=""/>
    <Field ID="FGWITHCD" Name="チェックデジット" Nullable="F" Order="4" Remarks="値がT(真)であれば、採番値の末尾にチェックデジット（モジュラス１０）を付加する。したがって冒頭文字を１文字指定して、チェックデジットを指定すれば、採番値は数字部桁に２を足した長さになる。" Size="1" Type="CHAR" TypeOptions="KUBUN(KBFLAG1)"/>
    <Key Fields="IDNUMBER" Type="PK"/>
  </Table><Table ActiveWhere="" ID="ZT050" Name="セッション" RangeKey="" Remarks="ユーザがシステムにログインすることで開始されるセッションの履歴を保持するためのテーブル" SubsystemID="Z">
    <Field ID="NRSESSION" Name="セッション№" Nullable="F" Order="0" Size="7" Type="CHAR" TypeOptions=""/>
    <Field ID="DTLOGIN" Name="ログイン日時" Nullable="F" Order="1" Size="26" Type="TIMESTAMP" TypeOptions=""/>
    <Field ID="DTLOGOUT" Name="ログアウト日時" Nullable="T" Order="2" Size="26" Type="TIMESTAMP" TypeOptions=""/>
    <Field ID="IDUSER" Name="ユーザＩＤ" Nullable="F" Order="3" Size="5" Type="CHAR" TypeOptions=""/>
    <Field ID="TXIPADDRESS" Name="ＩＰアドレス" Nullable="F" Order="4" Size="70" Type="CHAR" TypeOptions=""/>
    <Field ID="KBSESSIONSTATUS" Name="状態" Nullable="F" Order="5" Size="3" Type="CHAR" TypeOptions="VALUES(ACT;ERR;END)"/>
    <Key Fields="NRSESSION" Type="PK"/>
    <Refer Fields="TXNAME" Order="0" TableAlias="" ToKeyFields="" ToTable="ZT020" WithKeyFields="ZT050.IDUSER"/>
    <Script EventP="BC;BU;BD;AR" EventR="AR()" Name="セッション状態にもとづく配色設定" Order="0" Text="if (ZT050_KBSESSIONSTATUS.value == 'ERR') {#EOL#  ZT050_KBSESSIONSTATUS.color = 'red';#EOL#}#EOL#if (ZT050_KBSESSIONSTATUS.value.equals('ACT')) {#EOL#  ZT050_KBSESSIONSTATUS.color = 'green';#EOL#}"/>
  </Table><Table ActiveWhere="" ID="ZT010" Name="システム変数" RangeKey="" Remarks="企業名や年度開始月といったシステム変数を保持するためのテーブル" SubsystemID="Z">
    <Field ID="IDVARIANT" Name="変数ＩＤ" Nullable="F" Order="0010" Size="20" Type="CHAR" TypeOptions=""/>
    <Field ID="TXTYPE" Name="変数タイプ" Nullable="F" Order="0030" Size="10" Type="CHAR" TypeOptions="VALUES(STRING;NUMBER)"/>
    <Field ID="TXVALUE" Name="変数値" Nullable="F" Order="0040" Size="100" Type="CHAR" TypeOptions=""/>
    <Key Fields="IDVARIANT" Type="PK"/>
    <Field ID="TXNAME" Name="変数名" Nullable="F" Order="0020" Size="10" Type="CHAR" TypeOptions="KANJI"/>
    <Field ID="TXREMARKS" Name="摘要" Nullable="T" Order="0041" Remarks="" Size="500" Type="VARCHAR" TypeOptions="KANJI"/>
  </Table><Table ActiveWhere="" ID="ZT081" Name="月次為替レート" RangeKey="" Remarks="月次為替レートを保持するためのテーブル" SubsystemID="Z">
    <Field ID="KBCURRENCY" Name="通貨区分" Nullable="F" Order="0000" Size="5" Type="CHAR" TypeOptions="KUBUN(KBCURRENCY)"/>
    <Field ID="DTNEND" Name="年度" Nullable="F" Order="0001" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/>
    <Field ID="DTMSEQ" Name="月度" Nullable="F" Order="0011" Size="2" Type="SMALLINT" TypeOptions="MSEQ"/>
    <Field Decimal="3" ID="VLRATEB" Name="ＴＴＢレート" Nullable="F" Order="0012" Size="10" Type="NUMERIC" TypeOptions=""/>
    <Field Decimal="3" ID="VLRATEM" Name="ＴＴＭレート" Nullable="F" Order="0013" Size="10" Type="NUMERIC" TypeOptions=""/>
    <Field Decimal="3" ID="VLRATES" Name="ＴＴＳレート" Nullable="F" Order="0014" Size="10" Type="NUMERIC" TypeOptions=""/>
    <Key Fields="KBCURRENCY;DTNEND;DTMSEQ" Type="PK"/>
  </Table><Table ActiveWhere="" ID="ZT080" Name="年次為替レート" RangeKey="" Remarks="年次為替レートを保持するためのテーブル" SubsystemID="Z">
    <Field ID="KBCURRENCY" Name="通貨区分" Nullable="F" Order="0010" Size="5" Type="CHAR" TypeOptions="KUBUN(KBCURRENCY)"/>
    <Field Decimal="3" ID="VLRATEB" Name="ＴＴＢレート" Nullable="F" Order="0030" Size="10" Type="NUMERIC" TypeOptions=""/>
    <Field ID="DTNEND" Name="年度" Nullable="F" Order="0020" Size="4" Type="SMALLINT" TypeOptions="FYEAR"/>
    <Field Decimal="3" ID="VLRATEM" Name="ＴＴＭレート" Nullable="F" Order="0031" Size="10" Type="NUMERIC" TypeOptions=""/>
    <Field Decimal="3" ID="VLRATES" Name="ＴＴＳレート" Nullable="F" Order="0032" Size="10" Type="NUMERIC" TypeOptions=""/>
    <Key Fields="KBCURRENCY;DTNEND" Type="PK"/>
  </Table><Table ActiveWhere="" ID="TBL科目分類" Name="TBL科目分類" RangeKey="" Remarks="" SubsystemID="Y">
    <Field Decimal="" ID="科目分類C" Name="科目分類C" Nullable="F" Order="0000" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="科目分類名" Name="科目分類名" Nullable="T" Order="0010" Size="20" Type="VARCHAR" TypeOptions=""/>
    <Field Decimal="" ID="貸借区分" Name="貸借区分" Nullable="T" Order="0020" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="BP区分" Name="bp区分" Nullable="T" Order="0030" Size="6" Type="VARCHAR" TypeOptions=""/>
    <Key Fields="科目分類C" Type="PK"/>
  </Table><Table ActiveWhere="" ID="TBL勘定科目" Name="TBL勘定科目" RangeKey="" Remarks="" SubsystemID="Y">
    <Field Decimal="" ID="勘定科目C" Name="勘定科目c" Nullable="F" Order="0000" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="勘定科目名" Name="勘定科目名" Nullable="T" Order="0010" Size="20" Type="VARCHAR" TypeOptions=""/>
    <Field Decimal="" ID="科目階層" Name="科目階層" Nullable="T" Order="0020" Size="1" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="上位科目C" Name="上位科目c" Nullable="T" Order="0030" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="科目分類C" Name="科目分類c" Nullable="T" Order="0040" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="使用" Name="使用" Nullable="T" Order="0050" Size="1" Type="VARCHAR" TypeOptions=""/>
    <Key Fields="勘定科目C" Type="PK"/>
  <Refer Fields="勘定科目名" Order="0020" TableAlias="KAMOKU1" ToKeyFields="勘定科目C" ToTable="TBL勘定科目" WithKeyFields="TBL勘定科目.上位科目C"/><Refer Fields="科目分類名;貸借区分" Order="0030" TableAlias="" ToKeyFields="科目分類C" ToTable="TBL科目分類" WithKeyFields="TBL勘定科目.科目分類C"/></Table><Table ActiveWhere="" DetailRowNumberAuto="T" ID="TBL仕訳明細" Name="TBL仕訳明細" RangeKey="" Remarks="" SubsystemID="Y">
    <Field Decimal="" ID="仕訳NO" Name="仕訳NO" Nullable="F" Order="0000" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSIWAKE)"/>
    <Field Decimal="" ID="行NO" Name="行No" Nullable="F" Order="0010" Size="4" Type="SMALLINT" TypeOptions=""/>
    <Field Decimal="" ID="貸借区分" Name="貸借区分" Nullable="T" Order="0020" Size="4" Type="CHAR" TypeOptions="KUBUN(KBSIWAKE)"/>
    <Field Decimal="" ID="科目C" Name="科目C" Nullable="T" Order="0030" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="0" ID="仕訳額" Name="仕訳額" Nullable="T" Order="0040" Size="7" Type="NUMERIC" TypeOptions=""/>
    <Field Decimal="" ID="行摘要" Name="行摘要" Nullable="T" Order="0050" Size="50" Type="VARCHAR" TypeOptions=""/>
    <Key Fields="仕訳NO;行NO" Type="PK"/>
  <Refer Fields="借方金額;貸方金額" Order="0010" TableAlias="" ToKeyFields="仕訳NO" ToTable="TBL仕訳見出" WithKeyFields="TBL仕訳明細.仕訳NO"/><Refer Fields="勘定科目名" Order="0020" TableAlias="" ToKeyFields="勘定科目C" ToTable="TBL勘定科目" WithKeyFields="TBL仕訳明細.科目C"/><Script EventP="BC;BU" EventR="AR()" Function="" Name="仕訳見出し上のサマリ項目設定(YF021)" Order="0000" Text="if (instance.functionID == 'YF021') {#EOL#&#x9;var strKubun = TBL仕訳明細_貸借区分.value;#EOL#&#x9;strKubun = strKubun.trim();#EOL#//&#x9;javax.swing.JOptionPane.showMessageDialog(null, '[' + strKubun + ']' + Number(TBL仕訳明細_仕訳額.value));#EOL#&#x9;if (strKubun == '借方') {#EOL#&#x9;&#x9;TBL仕訳見出_借方金額.value = Number(TBL仕訳見出_借方金額.value) + Number(TBL仕訳明細_仕訳額.value);#EOL#&#x9;}#EOL#&#x9;if (strKubun == '貸方') {#EOL#&#x9;&#x9;TBL仕訳見出_貸方金額.value = Number(TBL仕訳見出_貸方金額.value) + Number(TBL仕訳明細_仕訳額.value);#EOL#&#x9;}#EOL#}"/></Table><Table ActiveWhere="" ID="TBL制御情報" Name="TBL制御情報" RangeKey="" Remarks="" SubsystemID="Y">
    <Field Decimal="" ID="制御キー" Name="制御キー" Nullable="F" Order="0000" Size="10" Type="VARCHAR" TypeOptions=""/>
    <Field Decimal="" ID="制御データ" Name="制御データ" Nullable="T" Order="0010" Size="6" Type="VARCHAR" TypeOptions=""/>
    <Key Fields="制御キー" Type="PK"/>
  </Table><Table ActiveWhere="" ID="TBL期首残高" Name="TBL期首残高" RangeKey="" Remarks="" SubsystemID="Y">
    <Field Decimal="" ID="会計年月" Name="会計年月" Nullable="F" Order="0000" Size="6" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="科目C" Name="科目C" Nullable="F" Order="0010" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="0" ID="前期繰越" Name="前期繰越" Nullable="T" Order="0020" Size="11" Type="NUMERIC" TypeOptions=""/>
    <Key Fields="科目C;会計年月" Type="PK"/>
  </Table><Table ActiveWhere="" ID="TBL仕訳見出" Name="TBL仕訳見出" RangeKey="" Remarks="" SubsystemID="Y">
    <Field Decimal="" ID="仕訳NO" Name="仕訳NO" Nullable="F" Order="0000" Size="7" Type="CHAR" TypeOptions="AUTO_NUMBER(NRSIWAKE)"/>
    <Field Decimal="" ID="仕訳日" Name="仕訳日" Nullable="F" Order="0010" Size="10" Type="DATE" TypeOptions=""/>
    <Field Decimal="" ID="部門C" Name="部門C" Nullable="T" Order="0020" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="見出摘要" Name="見出摘要" Nullable="T" Order="0030" Size="50" Type="VARCHAR" TypeOptions=""/>
    <Key Fields="仕訳NO" Type="PK"/>
  <Field Decimal="0" ID="借方金額" Name="借方金額" Nullable="T" Order="0040" Size="10" Type="NUMERIC" TypeOptions="VIRTUAL"/><Field Decimal="0" ID="貸方金額" Name="貸方金額" Nullable="T" Order="0040" Size="10" Type="NUMERIC" TypeOptions="VIRTUAL"/><Script EventP="AR" EventR="AS()" Function="" Name="仮想フィールドの計算" Order="0000" Text="//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var r仕訳明細;#EOL#var sum借方金額 = 0; var sum貸方金額 = 0;#EOL#var str貸借区分;#EOL#//////////////////////////////#EOL#// 借方金額と貸方金額の集計 //#EOL#//////////////////////////////#EOL##EOL#&#x9;r仕訳明細 = instance.createTableOperator('Select', 'TBL仕訳明細');#EOL#&#x9;r仕訳明細.setSelectFields('貸借区分,仕訳額');#EOL#&#x9;r仕訳明細.addKeyValue('仕訳NO',&#x9;TBL仕訳見出_仕訳NO.value);#EOL##EOL#&#x9;while (r仕訳明細.next()) {#EOL#&#x9;&#x9;str貸借区分 = r仕訳明細.getValueOf('貸借区分');#EOL#&#x9;&#x9;str貸借区分 = str貸借区分.trim();#EOL##EOL#&#x9;&#x9;if (str貸借区分 == '借方') {#EOL#&#x9;&#x9;&#x9;sum借方金額 += Number(r仕訳明細.getValueOf('仕訳額'));#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (str貸借区分 == '貸方') {#EOL#&#x9;&#x9;&#x9;sum貸方金額 += Number(r仕訳明細.getValueOf('仕訳額'));#EOL#&#x9;&#x9;}#EOL#//&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '[' + str貸借区分 + ']' + r仕訳明細.getValueOf('仕訳額'));#EOL#&#x9;}#EOL##EOL#//javax.swing.JOptionPane.showMessageDialog(null, sum借方金額);#EOL#TBL仕訳見出_借方金額.value = sum借方金額;#EOL#TBL仕訳見出_貸方金額.value = sum貸方金額;#EOL##EOL#//////////////////////////////////#EOL#// 借方金額と貸方金額のバランス //#EOL#//////////////////////////////////#EOL##EOL#if (instance.functionID == 'YF021') {#EOL#&#x9;if ((TBL仕訳見出_貸方金額.value - TBL仕訳見出_借方金額.value) != 0) {#EOL#&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, '借方金額と貸方金額のバランスがあっていません。Enterを入力してください。');#EOL#&#x9;&#x9;TBL仕訳見出_貸方金額.error = '貸方、借方不一致。' + (TBL仕訳見出_貸方金額.value - TBL仕訳見出_借方金額.value);#EOL#&#x9;&#x9;TBL仕訳見出_借方金額.error = '貸方、借方不一致。' + (TBL仕訳見出_借方金額.value - TBL仕訳見出_貸方金額.value);#EOL#&#x9;&#x9;TBL仕訳見出_貸方金額.color = 'red';#EOL#&#x9;&#x9;TBL仕訳見出_借方金額.color = 'red';#EOL#&#x9;}#EOL#}"/><Refer Fields="部門名" Order="0030" TableAlias="" ToKeyFields="部門C" ToTable="TBL会計部門" WithKeyFields="TBL仕訳見出.部門C"/><Script EventP="BC;BU" EventR="BR()" Function="" Name="更新時設定" Order="0010" Text="//////////////////#EOL#// 入力不可設定 //#EOL#//////////////////#EOL#TBL仕訳見出_借方金額.editable = false;#EOL#TBL仕訳見出_貸方金額.editable = false;#EOL#"/><Script EventP="BC;BU" EventR="AS()" Function="" Name="貸借の一致確認" Order="0020" Text="//テーブルスクリプトで、「明細データの処理後」#EOL#//すなわち「当該テーブルを見出しテーブルとするような機能において、明細テーブルのレコードがすべて読み込まれた後」という#EOL#//実行タイミングを指定できるようになっています。SalesOrosi.xeafのFT012(入荷明細)の「入力値チェック」のスクリプト、#EOL#//およびFT013(入荷仕入明細)の「入荷明細上のサマリ項目設定(FF032A/B)」のスクリプトが参考になると思います。#EOL#//FT012の「入力値チェック」のスクリプトの実行タイミングが「明細データの処理後」になっている点にご注目ください。#EOL##EOL#//////////////////////////////////#EOL#// 借方金額と貸方金額のバランス //#EOL#//////////////////////////////////#EOL#if (instance.functionID == 'YF021') {#EOL#&#x9;if ((Number(TBL仕訳見出_貸方金額.value) - Number(TBL仕訳見出_借方金額.value)) != 0) {#EOL#//&#x9;&#x9;***** 次行のshowMessageDialogを動作させると、明細の表示がおかしくなるので注意 *****#EOL#//&#x9;&#x9;javax.swing.JOptionPane.showMessageDialog(null, &quot;貸方、借方不一致&quot; + (TBL仕訳見出_借方金額.value - TBL仕訳見出_貸方金額.value));#EOL#&#x9;&#x9;TBL仕訳見出_貸方金額.error = '貸方、借方不一致。' + (TBL仕訳見出_貸方金額.value - TBL仕訳見出_借方金額.value);#EOL#&#x9;&#x9;TBL仕訳見出_借方金額.error = '貸方、借方不一致。' + (TBL仕訳見出_借方金額.value - TBL仕訳見出_貸方金額.value);#EOL#&#x9;}#EOL#}"/><Script EventP="BC;BU" EventR="BR()" Function="" Name="仮想フィールドの初期化" Order="0030" Text="if (instance.functionID == 'YF021') {#EOL#&#x9;TBL仕訳見出_借方金額.value = 0;#EOL#&#x9;TBL仕訳見出_貸方金額.value = 0;#EOL#}#EOL#"/><Script EventP="BR" EventR="" Function="" Name="仮想フィールドの計算、印刷" Order="0040" Text="//////////////////////////////#EOL#// 借方金額と貸方金額の集計 //#EOL#//////////////////////////////#EOL#if ((instance.functionID == 'YF110') || (instance.functionID == 'rpt仕訳伝票')) {#EOL#var r仕訳明細; var str貸借区分;#EOL#var sum借方金額 = 0; var sum貸方金額 = 0;#EOL#&#x9;r仕訳明細 = instance.createTableOperator('Select', 'TBL仕訳明細');#EOL#&#x9;r仕訳明細.setSelectFields('貸借区分,仕訳額');#EOL#&#x9;r仕訳明細.addKeyValue('仕訳NO',&#x9;TBL仕訳見出_仕訳NO.value);#EOL##EOL#&#x9;while (r仕訳明細.next()) {#EOL#&#x9;&#x9;str貸借区分 = r仕訳明細.getValueOf('貸借区分');#EOL#&#x9;&#x9;str貸借区分 = str貸借区分.trim();#EOL##EOL#&#x9;&#x9;if (str貸借区分 == '借方') {#EOL#&#x9;&#x9;&#x9;sum借方金額 += Number(r仕訳明細.getValueOf('仕訳額'));#EOL#&#x9;&#x9;}#EOL#&#x9;&#x9;if (str貸借区分 == '貸方') {#EOL#&#x9;&#x9;&#x9;sum貸方金額 += Number(r仕訳明細.getValueOf('仕訳額'));#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL#&#x9;TBL仕訳見出_借方金額.value = sum借方金額;#EOL#&#x9;TBL仕訳見出_貸方金額.value = sum貸方金額;#EOL#}"/></Table><Table ActiveWhere="" ID="TBL会計部門" Name="TBL会計部門" RangeKey="" Remarks="" SubsystemID="Y">
    <Field Decimal="" ID="部門C" Name="部門C" Nullable="F" Order="0000" Size="4" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="部門名" Name="部門名" Nullable="T" Order="0010" Size="20" Type="VARCHAR" TypeOptions=""/>
    <Field Decimal="" ID="部門階層" Name="部門階層" Nullable="T" Order="0020" Size="1" Type="CHAR" TypeOptions=""/>
    <Field Decimal="" ID="上位部門C" Name="上位部門C" Nullable="T" Order="0030" Size="4" Type="CHAR" TypeOptions=""/>
    <Key Fields="部門C" Type="PK"/>
  <Refer Fields="部門名" Order="0010" TableAlias="BUMON1" ToKeyFields="部門C" ToTable="TBL会計部門" WithKeyFields="TBL会計部門.上位部門C"/></Table><Function DetailFunction="AF011" ID="AF010" InitialMsg="" KeyFields="" Name="部門情報の一覧・保守" OrderBy="AT010.CDBUMON" PrimaryTable="AT010" Size="AUTO" SubsystemID="A" Type="XF100">
    <Filter DataSource="AT010.TXBUMON" FieldOptions="SCAN,CAPTION(部門名SCAN)" Order="0"/>
    <Column DataSource="AT010.TXBUMON" FieldOptions="" Order="1"/>
    <Column DataSource="AT010.NRKANRISYA" FieldOptions="" Order="2"/>
    <Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(管理者名)" Order="3"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="CALL(AF012)" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function HeaderFunction="AF012" HeaderKeyFields="" HeaderTable="AT010" ID="AF011" Name="部門と関連情報の確認" Size="AUTO" SubsystemID="A" Type="XF300">
    <Field DataSource="AT010.CDBUMON" FieldOptions="" Order="0010"/>
    <Field DataSource="AT010.TXBUMON" FieldOptions="" Order="0020"/>
    <Field DataSource="AT010.NRKANRISYA" FieldOptions="" Order="0030"/>
    <Field DataSource="AT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/>
    <Detail Caption="上位部門" DetailFunction="AF013" InitialMsg="" KeyFields="" Order="0" OrderBy="" Table="AT011">
      <Column DataSource="AT011.DTHAKKOUNENGETSU" FieldOptions="" Order="0010"/>
      <Column DataSource="AT011.CDJYOUIBUMON" FieldOptions="" Order="0030"/>
      <Column DataSource="AT011.DTSIKKOUNENGETSU" FieldOptions="" Order="0060"/>
      <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
      <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
      <Button Action="HEADER" Caption="部門情報" Number="8" Position="4"/>
      <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
      <Column DataSource="AT010A2.TXBUMON" FieldOptions="CAPTION(上位部門名)" Order="0040"/>
    </Detail>
    <Detail Caption="所属メンバー" DetailFunction="AF024" InitialMsg="" KeyFields="" Order="1" Table="AT021">
      <Column DataSource="AT021.DTSYOZOKUNENGETSU" FieldOptions="" Order="0020"/>
      <Column DataSource="AT021.DTSIKKONENGETSU" FieldOptions="" Order="0050"/>
      <Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(メンバー名)" Order="0070"/>
      <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
      <Button Action="HEADER" Caption="部門情報" Number="8" Position="4"/>
      <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    </Detail>
    <Field DataSource="AT010.TXTEKIYO" FieldOptions="" Order="0050"/>
  </Function>
  <Function DataName="部門情報" ID="AF012" InitialMsg="" KeyFields="" Name="部門情報の保守" PrimaryTable="AT010" Size="AUTO" SubsystemID="A" Type="XF200">
    <Field DataSource="AT010.CDBUMON" FieldOptions="" Order="0010"/>
    <Field DataSource="AT010.TXBUMON" FieldOptions="" Order="0020"/>
    <Field DataSource="AT010.NRKANRISYA" FieldOptions="" Order="0030"/>
    <Field DataSource="AT020.TXKANJI" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    <Field DataSource="AT010.TXTEKIYO" FieldOptions="" Order="0050"/>
  </Function>
  <Function DataName="上位部門" ID="AF013" InitialMsg="" KeyFields="" Name="上位部門の保守" PrimaryTable="AT011" Size="AUTO" SubsystemID="A" Type="XF200">
    <Field DataSource="AT011.CDBUMON" FieldOptions="" Order="0010"/>
    <Field DataSource="AT010A1.TXBUMON" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0020"/>
    <Field DataSource="AT011.CDJYOUIBUMON" FieldOptions="" Order="0030"/>
    <Field DataSource="AT010A2.TXBUMON" FieldOptions="NO_CAPTION,HORIZONTAL" Order="0040"/>
    <Field DataSource="AT011.DTHAKKOUNENGETSU" FieldOptions="" Order="0050"/>
    <Field DataSource="AT011.DTSIKKOUNENGETSU" FieldOptions="HORIZONTAL" Order="0060"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DetailFunction="AF021" ID="AF020" InitialMsg="" KeyFields="" Name="従業員情報の一覧・保守" OrderBy="AT020.TXKANA" PrimaryTable="AT020" Size="AUTO" SubsystemID="A" Type="XF100">
    <Filter DataSource="AT020.TXKANJI" FieldOptions="SCAN,CAPTION(漢字名SCAN)" Order="0"/>
    <Filter DataSource="AT020.TXKANA" FieldOptions="SCAN,CAPTION(カナ名SCAN)" Order="1"/>
    <Filter DataSource="AT020.KBKOYOU" FieldOptions="PROMPT_LIST1" Order="2"/>
    <Column DataSource="AT020.NRJYUGYOIN" FieldOptions="" Order="0"/>
    <Column DataSource="AT020.TXKANJI" FieldOptions="" Order="1"/>
    <Column DataSource="AT020.TXKANA" FieldOptions="" Order="2"/>
    <Column DataSource="AT020.KBKOYOU" FieldOptions="" Order="3"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="CALL(AF022)" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function HeaderFunction="AF022" HeaderKeyFields="" HeaderTable="AT020" ID="AF021" Name="従業員と関連情報の確認" Size="AUTO" SubsystemID="A" Type="XF300">
    <Field DataSource="AT020.NRJYUGYOIN" FieldOptions="" Order="0"/>
    <Field DataSource="AT020.TXKANA" FieldOptions="" Order="1"/>
    <Field DataSource="AT020.TXKANJI" FieldOptions="" Order="2"/>
    <Field DataSource="AT020.KBKOYOU" FieldOptions="" Order="3"/>
    <Field DataSource="AT020.DTNYUSYA" FieldOptions="HORIZONTAL" Order="4"/>
    <Field DataSource="AT020.DTTAISYA" FieldOptions="HORIZONTAL" Order="5"/>
    <Detail Caption="所属部門" DetailFunction="AF023" InitialMsg="" KeyFields="" Order="0" OrderBy="" Table="AT021">
      <Column DataSource="AT021.DTSYOZOKUNENGETSU" FieldOptions="" Order="0"/>
      <Column DataSource="AT021.CDBUMON" FieldOptions="" Order="1"/>
      <Column DataSource="AT010.TXBUMON" FieldOptions="CAPTION(所属部門名)" Order="2"/>
      <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
      <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
      <Button Action="HEADER" Caption="従業員情報" Number="8" Position="4"/>
      <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    </Detail>
  </Function>
  <Function DataName="従業員" ID="AF022" InitialMsg="" KeyFields="" Name="従業員情報の保守" PrimaryTable="AT020" Size="AUTO" SubsystemID="A" Type="XF200">
    <Field DataSource="AT020.NRJYUGYOIN" FieldOptions="" Order="0"/>
    <Field DataSource="AT020.TXKANA" FieldOptions="" Order="1"/>
    <Field DataSource="AT020.TXKANJI" FieldOptions="" Order="2"/>
    <Field DataSource="AT020.KBKOYOU" FieldOptions="" Order="3"/>
    <Field DataSource="AT020.DTNYUSYA" FieldOptions="" Order="4"/>
    <Field DataSource="AT020.DTTAISYA" FieldOptions="" Order="5"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DataName="所属情報" ID="AF023" InitialMsg="" KeyFields="" Name="従業員所属情報の保守" PrimaryTable="AT021" Size="AUTO" SubsystemID="A" Type="XF200">
    <Field DataSource="AT021.NRJYUGYOIN" FieldOptions="" Order="0"/>
    <Field DataSource="AT020.TXKANJI" FieldOptions="" Order="1"/>
    <Field DataSource="AT021.DTSYOZOKUNENGETSU" FieldOptions="" Order="2"/>
    <Field DataSource="AT021.CDBUMON" FieldOptions="PROMPT_CALL(AF100)" Order="3"/>
    <Field DataSource="AT010.TXBUMON" FieldOptions="NO_CAPTION,HORIZONTAL" Order="4"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DataName="所属情報" ID="AF024" InitialMsg="" KeyFields="" Name="従業員所属情報の表示" PrimaryTable="AT021" Size="AUTO" SubsystemID="A" Type="XF200">
    <Field DataSource="AT021.NRJYUGYOIN" FieldOptions="" Order="0"/>
    <Field DataSource="AT020.TXKANJI" FieldOptions="" Order="1"/>
    <Field DataSource="AT021.DTSYOZOKUNENGETSU" FieldOptions="" Order="2"/>
    <Field DataSource="AT021.CDBUMON" FieldOptions="" Order="3"/>
    <Field DataSource="AT010.TXBUMON" FieldOptions="NO_CAPTION,HORIZONTAL" Order="4"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DetailFunction="" ID="AF100" InitialMsg="" KeyFields="" Name="部門検索関数" OrderBy="AT010.CDBUMON" ParmType="COLUMNS" PrimaryTable="AT010" Size="AUTO" SubsystemID="A" Type="XF100">
    <Filter DataSource="AT010.TXBUMON" FieldOptions="SCAN,CAPTION(部門名SCAN)" Order="0"/>
    <Column DataSource="AT010.CDBUMON" FieldOptions="" Order="0"/>
    <Column DataSource="AT010.TXBUMON" FieldOptions="" Order="1"/>
    <Column DataSource="AT010.NRKANRISYA" FieldOptions="" Order="2"/>
    <Column DataSource="AT020.TXKANJI" FieldOptions="CAPTION(管理者名)" Order="3"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
  </Function>
  <Function DetailFunction="" ID="AF110" InitialMsg="" KeyFields="" Name="従業員検索関数" OrderBy="AT020.TXKANA" ParmType="COLUMNS" PrimaryTable="AT020" Size="AUTO" SubsystemID="A" Type="XF100">
    <Filter DataSource="AT020.TXKANJI" FieldOptions="SCAN,CAPTION(漢字名SCAN)" Order="0"/>
    <Filter DataSource="AT020.TXKANA" FieldOptions="SCAN,CAPTION(カナ名SCAN)" Order="1"/>
    <Filter DataSource="AT020.KBKOYOU" FieldOptions="PROMPT_LIST1" Order="2"/>
    <Column DataSource="AT020.NRJYUGYOIN" FieldOptions="" Order="0"/>
    <Column DataSource="AT020.TXKANJI" FieldOptions="" Order="1"/>
    <Column DataSource="AT020.TXKANA" FieldOptions="" Order="2"/>
    <Column DataSource="AT020.KBKOYOU" FieldOptions="" Order="3"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
  </Function>
  <Function DetailFunction="ZF011" ID="ZF010" InitialMsg="" KeyFields="" Name="システム変数の一覧・保守" OrderBy="ZT010.IDVARIANT" PrimaryTable="ZT010" Size="AUTO" SubsystemID="Z" Type="XF100">
    <Column DataSource="ZT010.IDVARIANT" FieldOptions="" Order="0010"/>
    <Column DataSource="ZT010.TXTYPE" FieldOptions="" Order="0040"/>
    <Column DataSource="ZT010.TXVALUE" FieldOptions="" Order="0050"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    <Filter DataSource="ZT010.TXNAME" FieldOptions="SCAN,CAPTION(変数名SCAN)" Order="0010"/>
    <Column DataSource="ZT010.TXNAME" FieldOptions="" Order="0030"/>
  </Function>
  <Function DataName="システム変数" ID="ZF011" InitialMsg="" KeyFields="" Name="システム変数の保守" PrimaryTable="ZT010" Size="AUTO" SubsystemID="Z" Type="XF200">
    <Field DataSource="ZT010.IDVARIANT" FieldOptions="" Order="0010"/>
    <Field DataSource="ZT010.TXTYPE" FieldOptions="" Order="0030"/>
    <Field DataSource="ZT010.TXVALUE" FieldOptions="" Order="0040"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    <Field DataSource="ZT010.TXNAME" FieldOptions="" Order="0020"/>
    <Field DataSource="ZT010.TXREMARKS" FieldOptions="" Order="0050"/>
  </Function>
  <Function DetailFunction="ZF021" ID="ZF020" InitialMsg="" KeyFields="" Name="ユーザの一覧・保守" OrderBy="ZT020.IDUSER" PrimaryTable="ZT020" Size="AUTO" SubsystemID="Z" Type="XF100">
    <Column DataSource="ZT020.IDUSER" FieldOptions="" Order="0010"/>
    <Column DataSource="ZT020.TXMENUS" FieldOptions="" Order="0050"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    <Filter DataSource="ZT020.TXNAME" FieldOptions="SCAN,CAPTION(ユーザ名SCAN)" Order="0010"/>
    <Column DataSource="ZT020.TXNAME" FieldOptions="" Order="0020"/>
    <Column DataSource="ZT020.TXEMAIL" FieldOptions="" Order="0030"/>
    <Column DataSource="ZT020.NREMPLOYEE" FieldOptions="" Order="0040"/>
  </Function>
  <Function DataName="ユーザ情報" ID="ZF021" InitialMsg="" KeyFields="" Name="ユーザの保守" PrimaryTable="ZT020" Size="AUTO" SubsystemID="Z" Type="XF200">
    <Field DataSource="ZT020.IDUSER" FieldOptions="" Order="0010"/>
    <Field DataSource="ZT020.TXPASSWORD" FieldOptions="COMMENT(デフォルトは0000000000のハッシュ値。セッション中でユーザ自身がF12で変更できます。)" Order="0040"/>
    <Field DataSource="ZT020.DTVALID" FieldOptions="" Order="0050"/>
    <Field DataSource="ZT020.DTEXPIRE" FieldOptions="" Order="0060"/>
    <Field DataSource="ZT020.TXMENUS" FieldOptions="COMMENT(メニューＩＤをコンマで区切って指定するか、ALLを指定してください。)" Order="0080"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    <Field DataSource="ZT020.NREMPLOYEE" FieldOptions="" Order="0020"/>
    <Field DataSource="ZT020.TXNAME" FieldOptions="" Order="0030"/>
    <Field DataSource="ZT020.TXEMAIL" FieldOptions="" Order="0070"/>
  </Function>
  <Function DetailFunction="ZF031" ID="ZF030" InitialMsg="" KeyFields="" Name="採番項目の一覧・保守" OrderBy="ZT030.IDNUMBER" PrimaryTable="ZT030" Size="AUTO" SubsystemID="Z" Type="XF100">
    <Filter DataSource="ZT030.IDNUMBER" FieldOptions="SCAN,CAPTION(番号ＩＤ SCAN)" Order="0"/>
    <Column DataSource="ZT030.IDNUMBER" FieldOptions="" Order="0"/>
    <Column DataSource="ZT030.TXPREFIX" FieldOptions="" Order="1"/>
    <Column DataSource="ZT030.NRNUMDIGIT" FieldOptions="" Order="2"/>
    <Column DataSource="ZT030.NRCURRENT" FieldOptions="" Order="3"/>
    <Column DataSource="ZT030.FGWITHCD" FieldOptions="CAPTION(C/D)" Order="4"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DataName="採番項目" ID="ZF031" InitialMsg="" KeyFields="" Name="採番項目の保守" PrimaryTable="ZT030" Size="AUTO" SubsystemID="Z" Type="XF200">
    <Field DataSource="ZT030.IDNUMBER" FieldOptions="" Order="0"/>
    <Field DataSource="ZT030.TXPREFIX" FieldOptions="" Order="1"/>
    <Field DataSource="ZT030.NRNUMDIGIT" FieldOptions="" Order="2"/>
    <Field DataSource="ZT030.NRCURRENT" FieldOptions="" Order="3"/>
    <Field DataSource="ZT030.FGWITHCD" FieldOptions="" Order="4"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DetailFunction="ZF041" ID="ZF040" InitialMsg="" KeyFields="" Name="ユーザ定義区分の一覧・保守" OrderBy="ZT040.IDUSERKUBUN;ZT040.SQLIST" PrimaryTable="ZT040" Size="AUTO" SubsystemID="Z" Type="XF100">
    <Filter DataSource="ZT040.IDUSERKUBUN" FieldOptions="SCAN,CAPTION(区分ＩＤ SCAN)" Order="0"/>
    <Column DataSource="ZT040.IDUSERKUBUN" FieldOptions="" Order="0"/>
    <Column DataSource="ZT040.SQLIST" FieldOptions="" Order="1"/>
    <Column DataSource="ZT040.KBUSERKUBUN" FieldOptions="" Order="2"/>
    <Column DataSource="ZT040.TXUSERKUBUN" FieldOptions="" Order="3"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DataName="ユーザ定義区分" ID="ZF041" InitialMsg="" KeyFields="" Name="ユーザ定義区分の保守" PrimaryTable="ZT040" Size="AUTO" SubsystemID="Z" Type="XF200">
    <Field DataSource="ZT040.IDUSERKUBUN" FieldOptions="" Order="0"/>
    <Field DataSource="ZT040.KBUSERKUBUN" FieldOptions="" Order="1"/>
    <Field DataSource="ZT040.TXUSERKUBUN" FieldOptions="" Order="2"/>
    <Field DataSource="ZT040.SQLIST" FieldOptions="" Order="3"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DetailFunction="ZF051" ID="ZF050" InitialMsg="" KeyFields="" Name="セッション状況の一覧" OrderBy="ZT050.NRSESSION(D)" PrimaryTable="ZT050" Size="AUTO" SubsystemID="Z" Type="XF100">
    <Filter DataSource="ZT050.DTLOGIN" FieldOptions="GENERIC,CAPTION(ログイン日時)" Order="0"/>
    <Filter DataSource="ZT050.KBSESSIONSTATUS" FieldOptions="PROMPT_LIST1" Order="2"/>
    <Column DataSource="ZT050.NRSESSION" FieldOptions="CAPTION(Session)" Order="0010"/>
    <Column DataSource="ZT050.DTLOGIN" FieldOptions="" Order="0020"/>
    <Column DataSource="ZT050.DTLOGOUT" FieldOptions="" Order="0030"/>
    <Column DataSource="ZT050.IDUSER" FieldOptions="CAPTION(User)" Order="0040"/>
    <Column DataSource="ZT050.TXIPADDRESS" FieldOptions="WIDTH(220)" Order="0070"/>
    <Column DataSource="ZT050.KBSESSIONSTATUS" FieldOptions="" Order="0080"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="CALL(ZF053)" Caption="LOGIN制御" Number="8" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    <Filter DataSource="ZT020.TXNAME" FieldOptions="SCAN,CAPTION(ユーザ名SCAN)" Order="0012"/>
    <Column DataSource="ZT020.TXNAME" FieldOptions="WIDTH(150)" Order="0060"/>
  </Function>
  <Function HeaderFunction="" HeaderKeyFields="" HeaderTable="ZT050" ID="ZF051" Name="セッションと関連情報の確認" Size="AUTO" SubsystemID="Z" Type="XF300">
    <Field DataSource="ZT050.NRSESSION" FieldOptions="" Order="0010"/>
    <Field DataSource="ZT050.DTLOGIN" FieldOptions="HORIZONTAL" Order="0020"/>
    <Field DataSource="ZT050.DTLOGOUT" FieldOptions="HORIZONTAL" Order="0030"/>
    <Field DataSource="ZT050.IDUSER" FieldOptions="" Order="0040"/>
    <Field DataSource="ZT050.TXIPADDRESS" FieldOptions="HORIZONTAL(28)" Order="0070"/>
    <Field DataSource="ZT050.KBSESSIONSTATUS" FieldOptions="" Order="0060"/>
    <Detail Caption="機能利用履歴" DetailFunction="ZF052" InitialMsg="" KeyFields="" Order="0" OrderBy="" Table="ZT051">
      <Column DataSource="ZT051.DTSTART" FieldOptions="" Order="0"/>
      <Column DataSource="ZT051.IDMENU" FieldOptions="" Order="1"/>
      <Column DataSource="ZT051.IDPROGRAM" FieldOptions="" Order="2"/>
      <Column DataSource="ZT051.TXPROGRAM" FieldOptions="" Order="3"/>
      <Column DataSource="ZT051.KBPROGRAMSTATUS" FieldOptions="" Order="4"/>
      <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
      <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    </Detail>
    <Field DataSource="ZT020.TXNAME" FieldOptions="HORIZONTAL(14)" Order="0050"/>
  </Function>
  <Function DetailFunction="ZF061" ID="ZF060" InitialMsg="" KeyFields="" Name="消費税率の一覧・保守" OrderBy="ZT060.DTSTART" PrimaryTable="ZT060" Size="AUTO" SubsystemID="Z" Type="XF100">
    <Filter DataSource="ZT060.DTSTART" FieldOptions="GENERIC,CAPTION(開始日上位桁)" Order="0"/>
    <Column DataSource="ZT060.DTSTART" FieldOptions="" Order="0"/>
    <Column DataSource="ZT060.VLTAXRATE" FieldOptions="" Order="1"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DataName="消費税率" ID="ZF061" InitialMsg="" KeyFields="" Name="消費税率の保守" PrimaryTable="ZT060" Size="AUTO" SubsystemID="Z" Type="XF200">
    <Field DataSource="ZT060.DTSTART" FieldOptions="" Order="0"/>
    <Field DataSource="ZT060.VLTAXRATE" FieldOptions="" Order="1"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DetailFunction="ZF071" ID="ZF070" InitialMsg="" KeyFields="" Name="休日の一覧・保守" OrderBy="ZT070.DTOFF" PrimaryTable="ZT070" Size="AUTO" SubsystemID="Z" Type="XF100">
    <Filter DataSource="ZT070.DTOFF" FieldOptions="GENERIC,CAPTION(休日上位桁)" Order="0"/>
    <Column DataSource="ZT070.DTOFF" FieldOptions="" Order="0"/>
    <Column DataSource="ZT070.TXOFF" FieldOptions="" Order="1"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DataName="休日" ID="ZF071" InitialMsg="" KeyFields="" Name="休日の保守" PrimaryTable="ZT070" Size="AUTO" SubsystemID="Z" Type="XF200">
    <Field DataSource="ZT070.DTOFF" FieldOptions="" Order="0"/>
    <Field DataSource="ZT070.TXOFF" FieldOptions="KANJI" Order="1"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="複写" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DataName="プログラム利用履歴" ID="ZF052" InitialMsg="" KeyFields="" Name="プログラム利用履歴の確認" PrimaryTable="ZT051" Size="" SubsystemID="Z" Type="XF200">
    <Field DataSource="ZT051.NRSESSION" FieldOptions="" Order="0010"/>
    <Field DataSource="ZT051.SQPROGRAM" FieldOptions="HORIZONTAL" Order="0040"/>
    <Field DataSource="ZT051.IDMENU" FieldOptions="" Order="0050"/>
    <Field DataSource="ZT051.IDPROGRAM" FieldOptions="HORIZONTAL" Order="0060"/>
    <Field DataSource="ZT051.TXPROGRAM" FieldOptions="HORIZONTAL" Order="0070"/>
    <Field DataSource="ZT051.KBPROGRAMSTATUS" FieldOptions="HORIZONTAL" Order="0080"/>
    <Field DataSource="ZT051.TXERRORLOG" FieldOptions="ROWS(16),WIDTH(850)" Order="0090"/>
    <Field DataSource="ZT051.DTSTART" FieldOptions="" Order="0100"/>
    <Field DataSource="ZT051.DTEND" FieldOptions="HORIZONTAL" Order="0110"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    <Field DataSource="ZT020.TXNAME" FieldOptions="WIDTH(250),HORIZONTAL" Order="0030"/>
  </Function>
  <Function ID="ZF053" Name="ログイン制御" Script="importPackage(javax.swing);#EOL##EOL#//////////////#EOL#// 変数定義 //#EOL#//////////////#EOL#var rZT010; var uZT010;#EOL#var count = 0; var errorMessage = ''; var ans;#EOL##EOL#//////////////////////////////////////////////////////////////////////////////////////#EOL#// システム変数テーブル(ZT010)のログイン認可フラグ(LOGIN_PERMITTED)を調べて更新する //#EOL#//////////////////////////////////////////////////////////////////////////////////////#EOL#rZT010 = instance.createTableOperator('Select', 'ZT010');#EOL#rZT010.addKeyValue('IDVARIANT',&#x9;'LOGIN_PERMITTED');#EOL#if (rZT010.next()) {#EOL##EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;// フラグをログイン禁止(F)として更新する //#EOL#&#x9;///////////////////////////////////////////#EOL#&#x9;var value  = rZT010.getValueOf('TXVALUE').trim();#EOL#&#x9;if (value == 'T') {#EOL##EOL#&#x9;&#x9;ans = JOptionPane.showConfirmDialog(null, '新たなログインを禁止しますか？', 'LOGIN制御', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;&#x9;if (ans == JOptionPane.OK_OPTION) {#EOL#&#x9;&#x9;&#x9;uZT010 = instance.createTableOperator('Update', 'ZT010');#EOL#&#x9;&#x9;&#x9;uZT010.addValue('TXVALUE',&#x9;'F');#EOL#&#x9;&#x9;&#x9;uZT010.addKeyValue('IDVARIANT',&#x9;'LOGIN_PERMITTED');#EOL#&#x9;&#x9;&#x9;count = uZT010.execute();#EOL#&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;instance.commit();#EOL#&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;errorMessage = 'システム変数(ZT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;} else {#EOL##EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;// フラグをログイン認可(T)として更新する //#EOL#&#x9;&#x9;///////////////////////////////////////////#EOL#&#x9;&#x9;if (value == 'F') {#EOL#&#x9;&#x9;&#x9;ans = JOptionPane.showConfirmDialog(null, '現在、新たなログインは禁止されています。解除しますか？', 'LOGIN制御', JOptionPane.OK_CANCEL_OPTION);#EOL#&#x9;&#x9;&#x9;if (ans == JOptionPane.OK_OPTION) {#EOL#&#x9;&#x9;&#x9;&#x9;uZT010 = instance.createTableOperator('Update', 'ZT010');#EOL#&#x9;&#x9;&#x9;&#x9;uZT010.addValue('TXVALUE','T');#EOL#&#x9;&#x9;&#x9;&#x9;uZT010.addKeyValue('IDVARIANT','LOGIN_PERMITTED');#EOL#&#x9;&#x9;&#x9;&#x9;count = uZT010.execute();#EOL#&#x9;&#x9;&#x9;&#x9;if (count == 1) {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;instance.commit();#EOL#&#x9;&#x9;&#x9;&#x9;} else {#EOL#&#x9;&#x9;&#x9;&#x9;&#x9;errorMessage = 'システム変数(ZT010)の更新に失敗しました。処理はキャンセルされます。';#EOL#&#x9;&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;&#x9;}#EOL#&#x9;&#x9;}#EOL#&#x9;}#EOL##EOL#&#x9;////////////////#EOL#&#x9;// エラー処理 //#EOL#&#x9;////////////////#EOL#&#x9;if (errorMessage != '') {#EOL#&#x9;&#x9;instance.cancelWithMessage(errorMessage);#EOL#&#x9;}#EOL#} else {#EOL#&#x9;JOptionPane.showMessageDialog(null, 'ログイン制御用のシステム変数(LOGIN_PERMITTED)が登録されていないので処理できません。');#EOL#}#EOL#" SubsystemID="Z" Type="XF000"/>
  <PrintFont FontName="Times-Roman" ID="Font0" PDFEncoding="Cp1252" PDFFontName="Times-Roman"/>
  <PrintFont FontName="Hゴシック" ID="Font1" PDFEncoding="UniJIS-UCS2-H" PDFFontName="HeiseiKakuGo-W5"/>
  <PrintFont FontName="H明朝" ID="Font2" PDFEncoding="UniJIS-UCS2-H" PDFFontName="HeiseiMin-W3"/>
  <Function DetailFunction="ZF081" ID="ZF080" InitialMsg="" KeyFields="" Name="年次為替レートの一覧・保守" OrderBy="" PrimaryTable="ZT080" Size="AUTO" SubsystemID="Z" Type="XF100">
    <Column DataSource="ZT080.KBCURRENCY" FieldOptions="CAPTION(通貨)" Order="0000"/>
    <Column DataSource="ZT080.DTNEND" FieldOptions="" Order="0010"/>
    <Column DataSource="ZT080.VLRATEB" FieldOptions="" Order="0020"/>
    <Column DataSource="ZT080.VLRATEM" FieldOptions="" Order="0030"/>
    <Column DataSource="ZT080.VLRATES" FieldOptions="" Order="0040"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    <Filter DataSource="ZT080.KBCURRENCY" FieldOptions="PROMPT_LIST1,CAPTION(通貨)" Order="0010"/>
    <Filter DataSource="ZT080.DTNEND" FieldOptions="" Order="0020"/>
  </Function>
  <Function ContinueAdd="T" ID="ZF081" InitialMsg="" KeyFields="" Name="年次為替レートの保守" PrimaryTable="ZT080" Size="AUTO" SubsystemID="Z" Type="XF200">
    <Field DataSource="ZT080.KBCURRENCY" FieldOptions="" Order="0000"/>
    <Field DataSource="ZT080.DTNEND" FieldOptions="HORIZONTAL" Order="0010"/>
    <Field DataSource="ZT080.VLRATEB" FieldOptions="" Order="0020"/>
    <Field DataSource="ZT080.VLRATEM" FieldOptions="" Order="0030"/>
    <Field DataSource="ZT080.VLRATES" FieldOptions="" Order="0040"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="コピー" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
  <Function DetailFunction="ZF083" ID="ZF082" InitialMsg="" KeyFields="" Name="月次為替レートの一覧・保守" OrderBy="" PrimaryTable="ZT081" Size="AUTO" SubsystemID="Z" Type="XF100">
    <Column DataSource="ZT081.KBCURRENCY" FieldOptions="CAPTION(通貨)" Order="0000"/>
    <Column DataSource="ZT081.DTNEND" FieldOptions="" Order="0010"/>
    <Column DataSource="ZT081.DTMSEQ" FieldOptions="" Order="0020"/>
    <Column DataSource="ZT081.VLRATEB" FieldOptions="" Order="0030"/>
    <Column DataSource="ZT081.VLRATEM" FieldOptions="" Order="0040"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="ADD" Caption="追加" Number="6" Position="3"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
    <Filter DataSource="ZT081.KBCURRENCY" FieldOptions="PROMPT_LIST1,CAPTION(通貨)" Order="0010"/>
    <Filter DataSource="ZT081.DTNEND" FieldOptions="" Order="0020"/>
  </Function>
  <Function ContinueAdd="T" ID="ZF083" InitialMsg="" KeyFields="" Name="月次為替レートの保守" PrimaryTable="ZT081" Size="AUTO" SubsystemID="Z" Type="XF200">
    <Field DataSource="ZT081.KBCURRENCY" FieldOptions="" Order="0000"/>
    <Field DataSource="ZT081.DTNEND" FieldOptions="HORIZONTAL" Order="0010"/>
    <Field DataSource="ZT081.DTMSEQ" FieldOptions="HORIZONTAL" Order="0020"/>
    <Field DataSource="ZT081.VLRATEB" FieldOptions="" Order="0030"/>
    <Field DataSource="ZT081.VLRATEM" FieldOptions="" Order="0040"/>
    <Field DataSource="ZT081.VLRATES" FieldOptions="" Order="0050"/>
    <Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/>
    <Button Action="EDIT" Caption="編集" Number="5" Position="2"/>
    <Button Action="COPY" Caption="コピー" Number="7" Position="3"/>
    <Button Action="DELETE" Caption="削除" Number="9" Position="4"/>
    <Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/>
  </Function>
<Function DetailFunction="YF022" ID="YF010" InitialMsg="" InitialReadCount="" KeyFields="" Name="仕訳見出し一覧" OrderBy="TBL仕訳見出.仕訳日(D)" PrimaryTable="TBL仕訳見出" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="TBL仕訳見出.仕訳NO" FieldOptions="" Order="0000"/><Column DataSource="TBL仕訳見出.仕訳日" FieldOptions="" Order="0010"/><Column DataSource="TBL仕訳見出.部門C" FieldOptions="" Order="0020"/><Column DataSource="TBL仕訳見出.見出摘要" FieldOptions="" Order="0030"/><Filter DataSource="TBL仕訳見出.仕訳NO" FieldOptions="" Order="0000"/><Filter DataSource="TBL仕訳見出.仕訳日" FieldOptions="" Order="0010"/><Filter DataSource="TBL仕訳見出.部門C" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(YF030)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/></Function><Function DetailKeyFields="" DetailTable="TBL仕訳明細" HeaderKeyFields="" HeaderTable="TBL仕訳見出" ID="YF021" Name="仕訳見出し／明細の保守" Size="AUTO" SubsystemID="Y" Type="XF310"><Field DataSource="TBL仕訳見出.仕訳NO" FieldOptions="" Order="0010"/><Field DataSource="TBL仕訳見出.仕訳日" FieldOptions="" Order="0020"/><Field DataSource="TBL仕訳見出.部門C" FieldOptions="" Order="0030"/><Field DataSource="TBL仕訳見出.見出摘要" FieldOptions="" Order="0050"/><Field DataSource="TBL仕訳見出.借方金額" FieldOptions="" Order="0060"/><Field DataSource="TBL仕訳見出.貸方金額" FieldOptions="HORIZONTAL" Order="0070"/><Column DataSource="TBL仕訳明細.行NO" FieldOptions="" Order="0010"/><Column DataSource="TBL仕訳明細.貸借区分" FieldOptions="" Order="0020"/><Column DataSource="TBL仕訳明細.科目C" FieldOptions="" Order="0030"/><Column DataSource="TBL仕訳明細.仕訳額" FieldOptions="" Order="0050"/><Column DataSource="TBL仕訳明細.行摘要" FieldOptions="" Order="0060"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="UPDATE" Caption="更新" Number="5" Position="2"/><Button Action="ADD_ROW" Caption="行追加" Number="6" Position="4"/><Button Action="REMOVE_ROW" Caption="行削除" Number="9" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="TBL会計部門.部門名" FieldOptions="ROWS(1),HORIZONTAL,PROMPT_CALL(YF060),PROMPT_CALL_TO_GET(TBL会計部門.部門C;TBL会計部門.部門名),PROMPT_CALL_TO_GET_TO(TBL仕訳見出.部門C;TBL会計部門.部門名)" Order="0040"/><Column DataSource="TBL勘定科目.勘定科目名" FieldOptions="PROMPT_CALL(YF050),PROMPT_CALL_TO_GET(TBL勘定科目.勘定科目C;TBL勘定科目.勘定科目名),PROMPT_CALL_TO_GET_TO(TBL仕訳明細.科目C;TBL勘定科目.勘定科目名)" Order="0040"/></Function><Function FunctionAfterInsert="YF021" ID="YF030" InitialMsg="" KeyFields="" Name="仕訳見出の追加" PrimaryTable="TBL仕訳見出" Size="AUTO" SubsystemID="Y" Type="XF200"><Field DataSource="TBL仕訳見出.仕訳NO" FieldOptions="" Order="0010"/><Field DataSource="TBL仕訳見出.仕訳日" FieldOptions="" Order="0020"/><Field DataSource="TBL仕訳見出.部門C" FieldOptions="" Order="0030"/><Field DataSource="TBL仕訳見出.見出摘要" FieldOptions="" Order="0050"/><Field DataSource="TBL仕訳見出.借方金額" FieldOptions="" Order="0060"/><Field DataSource="TBL仕訳見出.貸方金額" FieldOptions="" Order="0070"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="TBL会計部門.部門名" FieldOptions="PROMPT_CALL(YF060),PROMPT_CALL_TO_GET(TBL会計部門.部門C;TBL会計部門.部門名),PROMPT_CALL_TO_GET_TO(TBL仕訳見出.部門C;TBL会計部門.部門名)" Order="0040"/></Function><Function DetailFunction="YF100" ID="YF050" InitialMsg="" InitialReadCount="" KeyFields="" Name="勘定科目検索" OrderBy="" ParmType="COLUMNS" PrimaryTable="TBL勘定科目" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="TBL勘定科目.勘定科目C" FieldOptions="" Order="0010"/><Column DataSource="TBL勘定科目.勘定科目名" FieldOptions="" Order="0020"/><Column DataSource="TBL勘定科目.科目階層" FieldOptions="" Order="0030"/><Column DataSource="TBL勘定科目.上位科目C" FieldOptions="" Order="0040"/><Column DataSource="TBL勘定科目.科目分類C" FieldOptions="" Order="0060"/><Filter DataSource="TBL勘定科目.勘定科目C" FieldOptions="" Order="0000"/><Filter DataSource="TBL勘定科目.勘定科目名" FieldOptions="" Order="0010"/><Filter DataSource="TBL勘定科目.科目階層" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="KAMOKU1.勘定科目名" FieldOptions="" Order="0050"/><Column DataSource="TBL科目分類.科目分類名" FieldOptions="" Order="0070"/><Column DataSource="TBL科目分類.貸借区分" FieldOptions="" Order="0080"/></Function><Function DetailFunction="" ID="YF060" InitialMsg="" InitialReadCount="" KeyFields="" Name="会計部門検索" OrderBy="" ParmType="COLUMNS" PrimaryTable="TBL会計部門" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="TBL会計部門.部門C" FieldOptions="" Order="0010"/><Column DataSource="TBL会計部門.部門名" FieldOptions="" Order="0020"/><Column DataSource="TBL会計部門.部門階層" FieldOptions="" Order="0030"/><Column DataSource="TBL会計部門.上位部門C" FieldOptions="" Order="0040"/><Filter DataSource="TBL会計部門.部門C" FieldOptions="" Order="0000"/><Filter DataSource="TBL会計部門.部門名" FieldOptions="" Order="0010"/><Filter DataSource="TBL会計部門.部門階層" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="CALL(YF062)" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BUMON1.部門名" FieldOptions="CAPTION(上位部門名)" Order="0050"/></Function><Function DetailFunction="YF062" ID="YF061" InitialMsg="" InitialReadCount="" KeyFields="" Name="会計部門一覧" OrderBy="" PrimaryTable="TBL会計部門" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="TBL会計部門.部門C" FieldOptions="" Order="0010"/><Column DataSource="TBL会計部門.部門名" FieldOptions="" Order="0020"/><Column DataSource="TBL会計部門.部門階層" FieldOptions="" Order="0030"/><Column DataSource="TBL会計部門.上位部門C" FieldOptions="" Order="0040"/><Filter DataSource="TBL会計部門.部門C" FieldOptions="" Order="0000"/><Filter DataSource="TBL会計部門.部門名" FieldOptions="" Order="0010"/><Filter DataSource="TBL会計部門.部門階層" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="BUMON1.部門名" FieldOptions="CAPTION(上位部門名)" Order="0050"/></Function><Function ID="YF062" InitialMsg="" KeyFields="" Name="会計部門保守" PrimaryTable="TBL会計部門" Size="AUTO" SubsystemID="Y" Type="XF200"><Field DataSource="TBL会計部門.部門C" FieldOptions="" Order="0010"/><Field DataSource="TBL会計部門.部門名" FieldOptions="HORIZONTAL,PROMPT_CALL(YF060),PROMPT_CALL_TO_GET(TBL会計部門.部門C;TBL会計部門.部門名),PROMPT_CALL_TO_GET_TO(TBL仕訳見出.部門C;TBL会計部門.部門名)" Order="0020"/><Field DataSource="TBL会計部門.部門階層" FieldOptions="" Order="0030"/><Field DataSource="TBL会計部門.上位部門C" FieldOptions="" Order="0040"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="BUMON1.部門名" FieldOptions="HORIZONTAL,PROMPT_CALL(YF061),PROMPT_CALL_TO_GET(TBL会計部門.部門C;TBL会計部門.部門名),PROMPT_CALL_TO_GET_TO(TBL仕訳見出.部門C;TBL会計部門.部門名)" Order="0050"/></Function><Function DetailFunction="YF051" ID="YF080" InitialMsg="" InitialReadCount="" KeyFields="" Name="勘定科目一覧" OrderBy="" PrimaryTable="TBL勘定科目" Size="AUTO" SubsystemID="Y" Type="XF100"><Column DataSource="TBL勘定科目.勘定科目C" FieldOptions="" Order="0010"/><Column DataSource="TBL勘定科目.勘定科目名" FieldOptions="" Order="0020"/><Column DataSource="TBL勘定科目.科目階層" FieldOptions="" Order="0030"/><Column DataSource="TBL勘定科目.上位科目C" FieldOptions="" Order="0040"/><Column DataSource="TBL勘定科目.科目分類C" FieldOptions="" Order="0060"/><Filter DataSource="TBL勘定科目.勘定科目C" FieldOptions="" Order="0000"/><Filter DataSource="TBL勘定科目.勘定科目名" FieldOptions="" Order="0010"/><Filter DataSource="TBL勘定科目.科目階層" FieldOptions="" Order="0020"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="ADD" Caption="追加" Number="6" Position="3"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Column DataSource="KAMOKU1.勘定科目名" FieldOptions="" Order="0050"/><Column DataSource="TBL科目分類.科目分類名" FieldOptions="" Order="0070"/><Column DataSource="TBL科目分類.貸借区分" FieldOptions="" Order="0080"/></Function><Function ID="YF051" InitialMsg="" KeyFields="" Name="勘定科目保守" PrimaryTable="TBL勘定科目" Size="AUTO" SubsystemID="Y" Type="XF200"><Field DataSource="TBL勘定科目.勘定科目C" FieldOptions="" Order="0010"/><Field DataSource="TBL勘定科目.勘定科目名" FieldOptions="ROWS(1)" Order="0020"/><Field DataSource="TBL勘定科目.科目階層" FieldOptions="" Order="0030"/><Field DataSource="TBL勘定科目.上位科目C" FieldOptions="" Order="0040"/><Field DataSource="TBL勘定科目.科目分類C" FieldOptions="" Order="0060"/><Field DataSource="TBL勘定科目.使用" FieldOptions="WIDTH(100),ROWS(1)" Order="0090"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Button Action="EDIT" Caption="編集" Number="5" Position="2"/><Button Action="COPY" Caption="コピー" Number="7" Position="3"/><Button Action="DELETE" Caption="削除" Number="9" Position="4"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Field DataSource="KAMOKU1.勘定科目名" FieldOptions="ROWS(1),HORIZONTAL" Order="0050"/><Field DataSource="TBL科目分類.科目分類名" FieldOptions="WIDTH(300),ROWS(1),HORIZONTAL" Order="0070"/><Field DataSource="TBL科目分類.貸借区分" FieldOptions="WIDTH(300),ROWS(1),HORIZONTAL" Order="0080"/><Button Action="CALL(YF100)" Caption="印刷" Number="11" Position="6"/></Function><Function Direction="NORMAL" ID="YF100" KeyFields="" Margins="50;50;50;50" Name="rpt勘定科目" PageSize="A4" PrimaryTable="TBL勘定科目" SubsystemID="Y" Type="XF290" WithPageNumber="F"><Phrase Alignment="CENTER" Block="HEADER" FontID="Font1" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(勘定科目)  &amp;Date(jp21)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0020" SpacingAfter="0" Value="&amp;Text(TBL勘定科目.勘定科目C:) &amp;DataSource(TBL勘定科目.勘定科目C)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0030" SpacingAfter="0" Value="&amp;DataSource(TBL勘定科目.勘定科目名)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;DataSource(TBL勘定科目.科目階層)"/><Phrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0060" Value="&amp;DataSource(TBL勘定科目.上位科目C)"/><Phrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0070" Value="&amp;DataSource(TBL勘定科目.科目分類C)"/><Phrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0080" Value="&amp;DataSource(TBL勘定科目.使用)"/><Phrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0090" Value="&amp;DataSource(KAMOKU1.勘定科目名)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0100" SpacingAfter="0" Value="&amp;DataSource(TBL科目分類.科目分類名)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0110" SpacingAfter="0" Value="&amp;DataSource(TBL科目分類.科目分類名)"/><Phrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0120" SpacingAfter="0" Value=" &amp;Barcode(TBL勘定科目.勘定科目C;39)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0040" SpacingAfter="0" Value="&amp;DataSource(TBL勘定科目.勘定科目C)"/><Phrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0130" SpacingAfter="0" Value=" &amp;Rect(50;550;150;570)  &amp;Rect(150;550;250;570) &amp;Rect(250;550;350;570)&amp;Rect(350;550;450;570)&amp;Rect(450;550;550;570)"/></Function><Function DetailKeyFields="" DetailTable="TBL仕訳明細" Direction="NORMAL" HeaderKeyFields="" HeaderTable="TBL仕訳見出" ID="YF110" Margins="50;50;50;50" Name="rpt仕訳伝票" PageSize="A4" SubsystemID="Y" TableFontID="Font1" TableFontSize="9" TableRowNoWidth="5" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" Block="HEADER" FontID="Font1" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(仕訳伝票)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0020" Value="&amp;DataSource(TBL仕訳見出.仕訳NO)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0030" Value="&amp;DataSource(TBL仕訳見出.仕訳日)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0040" Value="&amp;DataSource(TBL仕訳見出.部門C)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;DataSource(TBL仕訳見出.見出摘要)"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.行NO" FieldOptions="" Order="0010" Width="12"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.貸借区分" FieldOptions="" Order="0020" Width="12"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.科目C" FieldOptions="" Order="0030" Width="12"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.仕訳額" FieldOptions="" Order="0050" Width="19"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.行摘要" FieldOptions="" Order="0060" Width="19"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0080" SpacingAfter="-18" Value="&amp;Text(借方金額：) &amp;DataSource(TBL仕訳見出.借方金額)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0090" SpacingAfter="0" Value="&amp;Text(貸方金額：) &amp;DataSource(TBL仕訳見出.貸方金額)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;DataSource(TBL会計部門.部門名)"/><Column Alignment="LEFT" DataSource="TBL勘定科目.勘定科目名" FieldOptions="" Order="0040" Width="10"/></Function><Function HeaderFunction="" HeaderKeyFields="" HeaderTable="TBL仕訳見出" ID="YF022" Name="仕訳見出し／明細の検討" Size="AUTO" SubsystemID="Y" Type="XF300"><Field DataSource="TBL仕訳見出.仕訳NO" FieldOptions="" Order="0010"/><Field DataSource="TBL仕訳見出.仕訳日" FieldOptions="" Order="0020"/><Field DataSource="TBL仕訳見出.部門C" FieldOptions="" Order="0030"/><Field DataSource="TBL仕訳見出.見出摘要" FieldOptions="" Order="0050"/><Field DataSource="TBL仕訳見出.借方金額" FieldOptions="" Order="0060"/><Field DataSource="TBL仕訳見出.貸方金額" FieldOptions="HORIZONTAL" Order="0070"/><Detail Caption="TBL仕訳明細" DetailFunction="" HeaderKeyFields="" InitialMsg="" KeyFields="" Order="0010" ParmType="COLUMNS" Table="TBL仕訳明細"><Column DataSource="TBL仕訳明細.行NO" FieldOptions="" Order="0010"/><Column DataSource="TBL仕訳明細.貸借区分" FieldOptions="" Order="0020"/><Column DataSource="TBL仕訳明細.科目C" FieldOptions="" Order="0030"/><Column DataSource="TBL仕訳明細.仕訳額" FieldOptions="" Order="0050"/><Column DataSource="TBL仕訳明細.行摘要" FieldOptions="" Order="0060"/><Button Action="CALL(rpt仕訳伝票)" Caption="印刷" Number="11" Position="5"/><Button Action="OUTPUT" Caption="出力" Number="12" Position="6"/><Button Action="CALL(YF021)" Caption="保守" Number="7" Position="3"/><Button Action="EXIT" Caption="閉じる" Number="3" Position="0"/><Column DataSource="TBL勘定科目.勘定科目名" FieldOptions="" Order="0040"/></Detail><Field DataSource="TBL会計部門.部門名" FieldOptions="WIDTH(200),ROWS(1),HORIZONTAL" Order="0040"/></Function><Function ID="YF580" Name="帳票レポート InputDialog" Script="////////////////////////#EOL#// JDBCSwingQuery表示 //#EOL#////////////////////////#EOL#importPackage(java.awt);#EOL#importPackage(javax.swing);#EOL#importPackage(javax.swing.table);#EOL#importPackage(java.sql);#EOL#importPackage(java.util);#EOL##EOL##EOL#var dialog = session.getInputDialog();#EOL#dialog.setMessage('＊出力する帳票を選択してください。');#EOL##EOL#var nrHinban = dialog.addField('品番','セッションID','ALPHA',0);#EOL#nrHinban.setEditable(false);#EOL#nrHinban.setSize(15);#EOL#//nrHinban.setValue(123);#EOL#nrHinban.setValue(session.sessionID);#EOL#//nrHinban.setValue(session.getSystemVariantString('NRSIWAKE') + '');#EOL##EOL#//var qtTenkai= dialog.addField('展開基準数','NUMELIC','NUMELIC',1);#EOL#//qtTenkai.setValue(1);#EOL#//qtTenkai.setSize(7);#EOL##EOL#var bkTenkai = dialog.addField('帳票選択区分','帳票選択','LISTBOX',1);#EOL#bkTenkai.addItem(&quot;1:仕訳日記帳&quot;,'1');#EOL#bkTenkai.addItem(&quot;2:総勘定元帳&quot;,'2');#EOL#bkTenkai.addItem(&quot;3:残高試算表&quot;,'3');#EOL#bkTenkai.addItem(&quot;4:精　算　表&quot;,'4');#EOL#bkTenkai.addItem(&quot;5:損益計算書&quot;,'5');#EOL#bkTenkai.addItem(&quot;6:貸借対照表&quot;,'6');#EOL##EOL#//var fgPassthru = dialog.addField('パススルー展開','パススルー展開','CHECKBOX',1);#EOL#//fgPassthru.setValue(true);#EOL##EOL#var replay = dialog.request('出力帳票の選択・確認');#EOL#if(replay == 0) {#EOL#&#x9;if (bkTenkai.value == 1) {#EOL#&#x9;&#x9;strSQL = &quot;with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出&#x9;), qry仕訳明細 as ( SELECT 仕訳no, 行no, 貸借区分, 科目c, 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細 ) SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行no, qry仕訳明細.科目c, (select 勘定科目名 from tbl勘定科目 where 勘定科目c = 科目c) as 科目名, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳no = qry仕訳見出.仕訳no ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳明細.行no ) select * from qry仕訳日記帳 order by 仕訳日, 仕訳no, 行no ;&quot; ;#EOL#&#x9;}#EOL#&#x9;if (bkTenkai.value == 2) {#EOL#&#x9;&#x9;strSQL = &quot;with qry元帳明細 as ( with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出 ) , qry仕訳明細 as ( SELECT 仕訳no, 行no, 貸借区分, 科目c, 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細) SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行no, qry仕訳明細.科目c, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳no = qry仕訳見出.仕訳no ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳明細.行no) SELECT qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, tbl科目分類.貸借区分 AS 貸借区分, qry仕訳日記帳.仕訳日, qry仕訳日記帳.借方, qry仕訳日記帳.貸方, qry仕訳日記帳.見出摘要, qry仕訳日記帳.部門c, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no, qry仕訳日記帳.行摘要 FROM qry仕訳日記帳 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c) ON qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c ORDER BY qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, qry仕訳日記帳.仕訳日, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no), qry元帳前繰 as ( SELECT tbl期首残高.会計年月, tbl期首残高.科目c, tbl勘定科目.勘定科目名, tbl科目分類.貸借区分, substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日, tbl期首残高.前期繰越, case when (貸借区分='借方') then 前期繰越 else 0 end as 借方, case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方, '前期繰越' AS 摘要 FROM ( tbl期首残高 INNER JOIN tbl勘定科目 ON tbl期首残高.科目c = tbl勘定科目.勘定科目c) INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c) SELECT qry元帳前繰.会計年月, qry元帳前繰.科目c, qry元帳前繰.貸借区分, qry元帳前繰.仕訳日::timestamp with time zone, qry元帳前繰.借方, qry元帳前繰.貸方, qry元帳前繰.摘要::text, 0 AS 並順, '' AS 仕訳no, 0 AS 行no FROM qry元帳前繰 UNION SELECT qry元帳明細.会計年月, qry元帳明細.科目c, qry元帳明細.貸借区分, qry元帳明細.仕訳日, qry元帳明細.借方, qry元帳明細.貸方, qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要, 1 AS 並順, 仕訳no, 行no FROM qry元帳明細 ORDER BY 会計年月, 科目c, 仕訳日, 並順, 仕訳no, 行no;&quot; ;#EOL#&#x9;}#EOL#&#x9;if (bkTenkai.value == 3) {#EOL#&#x9;&#x9;strSQL = &quot;with qry総勘定元帳 as (  with qry元帳明細 as (  with qry仕訳日記帳 as (  with qry仕訳見出 as (  SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月  FROM tbl仕訳見出 ) ,  qry仕訳明細 as (  SELECT  仕訳no,  行no,  貸借区分,  科目c,  仕訳額,  行摘要,  case when (貸借区分='借方') then 仕訳額 else 0 end as 借方,  case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方  FROM  tbl仕訳明細  )  SELECT  qry仕訳見出.会計年月,  qry仕訳見出.仕訳日,  qry仕訳見出.仕訳no,  qry仕訳見出.部門c,  qry仕訳見出.見出摘要,  qry仕訳明細.行no,  qry仕訳明細.科目c,  qry仕訳明細.借方,  qry仕訳明細.貸方,  qry仕訳明細.行摘要  FROM  qry仕訳明細  INNER JOIN  qry仕訳見出 ON  qry仕訳明細.仕訳no = qry仕訳見出.仕訳no  ORDER BY  qry仕訳見出.仕訳日,  qry仕訳見出.仕訳no,  qry仕訳明細.行no )  SELECT  qry仕訳日記帳.会計年月,  qry仕訳日記帳.科目c,  tbl科目分類.貸借区分 AS 貸借区分,  qry仕訳日記帳.仕訳日,  qry仕訳日記帳.借方,  qry仕訳日記帳.貸方,  qry仕訳日記帳.見出摘要,  qry仕訳日記帳.部門c,  qry仕訳日記帳.仕訳no,  qry仕訳日記帳.行no,  qry仕訳日記帳.行摘要  FROM  qry仕訳日記帳  INNER JOIN  (  tbl勘定科目  INNER JOIN  tbl科目分類 ON  tbl勘定科目.科目分類c = tbl科目分類.科目分類c  ) ON  qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c  ORDER BY  qry仕訳日記帳.会計年月,  qry仕訳日記帳.科目c,  qry仕訳日記帳.仕訳日,  qry仕訳日記帳.仕訳no,  qry仕訳日記帳.行no ) , qry元帳前繰 as ( SELECT  tbl期首残高.会計年月,  tbl期首残高.科目c,  tbl勘定科目.勘定科目名,  tbl科目分類.貸借区分,  substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日,  tbl期首残高.前期繰越,  case when (貸借区分='借方') then 前期繰越 else 0 end as 借方,  case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方,  前期繰越 AS 摘要  FROM  (  tbl期首残高  INNER JOIN  tbl勘定科目 ON  tbl期首残高.科目c = tbl勘定科目.勘定科目c  )  INNER JOIN  tbl科目分類 ON  tbl勘定科目.科目分類c = tbl科目分類.科目分類c  )  SELECT  qry元帳前繰.会計年月,  qry元帳前繰.科目c,  qry元帳前繰.貸借区分,  qry元帳前繰.仕訳日::timestamp with time zone,  qry元帳前繰.借方,  qry元帳前繰.貸方,  qry元帳前繰.摘要::text,  0 AS 並順,  '' AS 仕訳no,  0 AS 行no  FROM  qry元帳前繰  UNION  SELECT  qry元帳明細.会計年月,  qry元帳明細.科目c,  qry元帳明細.貸借区分,  qry元帳明細.仕訳日,  qry元帳明細.借方,  qry元帳明細.貸方,  qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要,  1 AS 並順,  仕訳no,  行no  FROM  qry元帳明細  ORDER BY  会計年月,  科目c,  仕訳日,  並順,  仕訳no,  行no )  SELECT  qry総勘定元帳.会計年月,  qry総勘定元帳.科目c,  tbl勘定科目.勘定科目名,  qry総勘定元帳.貸借区分,  SUM(qry総勘定元帳.借方) AS 借方合計,  SUM(qry総勘定元帳.貸方) AS 貸方合計,  sum(case when (貸借区分='借方') then qry総勘定元帳.借方-qry総勘定元帳.貸方 else 0 end) as 借方残高,  sum(case when (貸借区分='貸方') then qry総勘定元帳.貸方-qry総勘定元帳.借方 else 0 end) as 貸方残高  FROM  qry総勘定元帳  INNER JOIN  tbl勘定科目 ON  qry総勘定元帳.科目c = tbl勘定科目.勘定科目c  GROUP BY  qry総勘定元帳.会計年月,  qry総勘定元帳.科目c,  tbl勘定科目.勘定科目名,  qry総勘定元帳.貸借区分;&quot;;#EOL#&#x9;}#EOL#&#x9;if (bkTenkai.value == 4) {#EOL#&#x9;&#x9;strSQL = &quot;with qry残高試算表 as ( with qry総勘定元帳 as ( with qry元帳明細 as ( with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出),qry仕訳明細 as ( SELECT 仕訳No, 行No, 貸借区分, 科目c, (select 勘定科目名 from tbl勘定科目 where 勘定科目c = 科目c), 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細)SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳No, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行No, qry仕訳明細.科目c, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳No = qry仕訳見出.仕訳No ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳No, qry仕訳明細.行No)SELECT qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, tbl科目分類.貸借区分 AS 貸借区分, qry仕訳日記帳.仕訳日, qry仕訳日記帳.借方, qry仕訳日記帳.貸方, qry仕訳日記帳.見出摘要, qry仕訳日記帳.部門c, qry仕訳日記帳.仕訳No, qry仕訳日記帳.行No, qry仕訳日記帳.行摘要 FROM qry仕訳日記帳 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c ORDER BY qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, qry仕訳日記帳.仕訳日, qry仕訳日記帳.仕訳No, qry仕訳日記帳.行No) , qry元帳前繰 as ( SELECT tbl期首残高.会計年月, tbl期首残高.科目c, tbl勘定科目.勘定科目名, tbl科目分類.貸借区分, substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日, tbl期首残高.前期繰越, case when (貸借区分='借方') then 前期繰越 else 0 end as 借方, case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方, 前期繰越 AS 摘要 FROM ( tbl期首残高 INNER JOIN tbl勘定科目 ON tbl期首残高.科目c = tbl勘定科目.勘定科目c ) INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c )SELECT qry元帳前繰.会計年月, qry元帳前繰.科目c, qry元帳前繰.貸借区分, qry元帳前繰.仕訳日::timestamp with time zone, qry元帳前繰.借方, qry元帳前繰.貸方, qry元帳前繰.摘要::text, 0 AS 並順, '' AS 仕訳No, 0 AS 行No FROM qry元帳前繰 UNION SELECT qry元帳明細.会計年月, qry元帳明細.科目c, qry元帳明細.貸借区分, qry元帳明細.仕訳日, qry元帳明細.借方, qry元帳明細.貸方, qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要, 1 AS 並順, 仕訳No, 行No FROM qry元帳明細 ORDER BY 会計年月, 科目c, 仕訳日, 並順, 仕訳No, 行No)SELECT qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分, SUM(qry総勘定元帳.借方) AS 借方合計, SUM(qry総勘定元帳.貸方) AS 貸方合計, sum(case when (貸借区分='借方') then qry総勘定元帳.借方-qry総勘定元帳.貸方 else 0 end) as 借方残高, sum(case when (貸借区分='貸方') then qry総勘定元帳.貸方-qry総勘定元帳.借方 else 0 end) as 貸方残高 FROM qry総勘定元帳 INNER JOIN tbl勘定科目 ON qry総勘定元帳.科目c = tbl勘定科目.勘定科目c GROUP BY qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分)SELECT qry残高試算表.*, tbl科目分類.bp区分, case when (bp区分='Ｂ／Ｓ') then 借方残高 else 0 end AS BS借方, case when (bp区分='Ｂ／Ｓ') then 貸方残高 else 0 end AS BS貸方, case when (bp区分='Ｐ／Ｌ') then 借方残高 else 0 end AS PL借方, case when (bp区分='Ｐ／Ｌ') then 貸方残高 else 0 end AS PL貸方 FROM qry残高試算表 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry残高試算表.科目c = tbl勘定科目.勘定科目c;&quot;;#EOL#&#x9;}#EOL#&#x9;if (bkTenkai.value == 5) {#EOL#&#x9;&#x9;strSQL = &quot;with qry精算表 as ( with qry残高試算表 as ( with qry総勘定元帳 as ( with qry元帳明細 as ( with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出), qry仕訳明細 as ( SELECT 仕訳no, 行no, 貸借区分, 科目c, 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細) SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行no, qry仕訳明細.科目c, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳no = qry仕訳見出.仕訳no ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳明細.行no) SELECT qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, tbl科目分類.貸借区分 AS 貸借区分, qry仕訳日記帳.仕訳日, qry仕訳日記帳.借方, qry仕訳日記帳.貸方, qry仕訳日記帳.見出摘要, qry仕訳日記帳.部門c, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no, qry仕訳日記帳.行摘要 FROM qry仕訳日記帳 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c ORDER BY qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, qry仕訳日記帳.仕訳日, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no) , qry元帳前繰 as ( SELECT tbl期首残高.会計年月, tbl期首残高.科目c, tbl勘定科目.勘定科目名, tbl科目分類.貸借区分, substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日, tbl期首残高.前期繰越, case when (貸借区分='借方') then 前期繰越 else 0 end as 借方, case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方, 前期繰越 AS 摘要 FROM ( tbl期首残高 INNER JOIN tbl勘定科目 ON tbl期首残高.科目c = tbl勘定科目.勘定科目c ) INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) SELECT qry元帳前繰.会計年月, qry元帳前繰.科目c, qry元帳前繰.貸借区分, qry元帳前繰.仕訳日::timestamp with time zone, qry元帳前繰.借方, qry元帳前繰.貸方, qry元帳前繰.摘要::text, 0 AS 並順, '' AS 仕訳no, 0 AS 行no FROM qry元帳前繰 UNION SELECT qry元帳明細.会計年月, qry元帳明細.科目c, qry元帳明細.貸借区分, qry元帳明細.仕訳日, qry元帳明細.借方, qry元帳明細.貸方, qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要, 1 AS 並順, 仕訳no, 行no FROM qry元帳明細 ORDER BY 会計年月, 科目c, 仕訳日, 並順, 仕訳no, 行no) SELECT qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分, SUM(qry総勘定元帳.借方) AS 借方合計, SUM(qry総勘定元帳.貸方) AS 貸方合計, sum(case when (貸借区分='借方') then qry総勘定元帳.借方-qry総勘定元帳.貸方 else 0 end) as 借方残高, sum(case when (貸借区分='貸方') then qry総勘定元帳.貸方-qry総勘定元帳.借方 else 0 end) as 貸方残高 FROM qry総勘定元帳 INNER JOIN tbl勘定科目 ON qry総勘定元帳.科目c = tbl勘定科目.勘定科目c GROUP BY qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分) SELECT qry残高試算表.*, tbl科目分類.bp区分, case when (bp区分='Ｂ／Ｓ') then 借方残高 else 0 end AS BS借方, case when (bp区分='Ｂ／Ｓ') then 貸方残高 else 0 end AS BS貸方, case when (bp区分='Ｐ／Ｌ') then 借方残高 else 0 end AS PL借方, case when (bp区分='Ｐ／Ｌ') then 貸方残高 else 0 end AS PL貸方 FROM qry残高試算表 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry残高試算表.科目c = tbl勘定科目.勘定科目c) SELECT qry精算表.会計年月, qry精算表.科目c, qry精算表.勘定科目名, qry精算表.PL借方 AS 借方, qry精算表.PL貸方 AS 貸方 FROM qry精算表 WHERE (((qry精算表.bp区分)='Ｐ／Ｌ'));&quot;;#EOL#&#x9;}#EOL#&#x9;if (bkTenkai.value == 6) {#EOL#&#x9;&#x9;strSQL = &quot;with qry精算表 as ( with qry残高試算表 as ( with qry総勘定元帳 as ( with qry元帳明細 as ( with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出), qry仕訳明細 as ( SELECT 仕訳no, 行no, 貸借区分, 科目c, 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細) SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行no, qry仕訳明細.科目c, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳no = qry仕訳見出.仕訳no ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳明細.行no) SELECT qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, tbl科目分類.貸借区分 AS 貸借区分, qry仕訳日記帳.仕訳日, qry仕訳日記帳.借方, qry仕訳日記帳.貸方, qry仕訳日記帳.見出摘要, qry仕訳日記帳.部門c, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no, qry仕訳日記帳.行摘要 FROM qry仕訳日記帳 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c ORDER BY qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, qry仕訳日記帳.仕訳日, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no) , qry元帳前繰 as ( SELECT tbl期首残高.会計年月, tbl期首残高.科目c, tbl勘定科目.勘定科目名, tbl科目分類.貸借区分, substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日, tbl期首残高.前期繰越, case when (貸借区分='借方') then 前期繰越 else 0 end as 借方, case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方, 前期繰越 AS 摘要 FROM ( tbl期首残高 INNER JOIN tbl勘定科目 ON tbl期首残高.科目c = tbl勘定科目.勘定科目c ) INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) SELECT qry元帳前繰.会計年月, qry元帳前繰.科目c, qry元帳前繰.貸借区分, qry元帳前繰.仕訳日::timestamp with time zone, qry元帳前繰.借方, qry元帳前繰.貸方, qry元帳前繰.摘要::text, 0 AS 並順, '' AS 仕訳no, 0 AS 行no FROM qry元帳前繰 UNION SELECT qry元帳明細.会計年月, qry元帳明細.科目c, qry元帳明細.貸借区分, qry元帳明細.仕訳日, qry元帳明細.借方, qry元帳明細.貸方, qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要, 1 AS 並順, 仕訳no, 行no FROM qry元帳明細 ORDER BY 会計年月, 科目c, 仕訳日, 並順, 仕訳no, 行no)SELECT qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分, SUM(qry総勘定元帳.借方) AS 借方合計, SUM(qry総勘定元帳.貸方) AS 貸方合計, sum(case when (貸借区分='借方') then qry総勘定元帳.借方-qry総勘定元帳.貸方 else 0 end) as 借方残高, sum(case when (貸借区分='貸方') then qry総勘定元帳.貸方-qry総勘定元帳.借方 else 0 end) as 貸方残高 FROM qry総勘定元帳 INNER JOIN tbl勘定科目 ON qry総勘定元帳.科目c = tbl勘定科目.勘定科目c GROUP BY qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分)SELECT qry残高試算表.*, tbl科目分類.bp区分, case when (bp区分='Ｂ／Ｓ') then 借方残高 else 0 end AS BS借方, case when (bp区分='Ｂ／Ｓ') then 貸方残高 else 0 end AS BS貸方, case when (bp区分='Ｐ／Ｌ') then 借方残高 else 0 end AS PL借方, case when (bp区分='Ｐ／Ｌ') then 貸方残高 else 0 end AS PL貸方 FROM qry残高試算表 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry残高試算表.科目c = tbl勘定科目.勘定科目c) SELECT qry精算表.会計年月, qry精算表.科目c, qry精算表.勘定科目名, qry精算表.BS借方 AS 借方, qry精算表.BS貸方 AS 貸方 FROM qry精算表 WHERE (((qry精算表.bp区分)='Ｂ／Ｓ'));&quot;;#EOL#&#x9;}#EOL#&#x9;var obj = new JDBCSwingQuery(strSQL);#EOL#} else{#EOL#&#x9;instance.returnMap.put('RETURN_MESSAGE','処理は取り消されました。');#EOL#}#EOL#" SubsystemID="Y" Type="XF000"/><Function ID="YF570" Name="帳票レポート OptionDialog" Script="////////////////////////#EOL#// JDBCSwingQuery表示 //#EOL#////////////////////////#EOL#importPackage(java.awt);#EOL#importPackage(javax.swing);#EOL#importPackage(javax.swing.table);#EOL#importPackage(java.sql);#EOL#importPackage(java.util);#EOL##EOL#var strSQL = '';#EOL#var dialog = session.getOptionDialog();#EOL#dialog.addOption('仕訳日記帳'); // 0 //#EOL#dialog.addOption('総勘定元帳'); // 1 //#EOL#dialog.addOption('残高試算表'); // 2 //#EOL#dialog.addOption('精　算　表'); // 3 //#EOL#dialog.addOption('損益計算書'); // 4 //#EOL#dialog.addOption('貸借対照表'); // 5 //#EOL##EOL#var reply = dialog.request('帳票区分選択');#EOL#if (reply == 0) {#EOL#&#x9;strSQL = &quot;with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出&#x9;), qry仕訳明細 as ( SELECT 仕訳no, 行no, 貸借区分, 科目c, 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細 ) SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行no, qry仕訳明細.科目c, (select 勘定科目名 from tbl勘定科目 where 勘定科目c = 科目c) as 科目名, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳no = qry仕訳見出.仕訳no ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳明細.行no ) select * from qry仕訳日記帳 order by 仕訳日, 仕訳no, 行no ;&quot; ;#EOL#}#EOL#if (reply == 1) {#EOL#&#x9;strSQL = &quot;with qry元帳明細 as ( with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出 ) , qry仕訳明細 as ( SELECT 仕訳no, 行no, 貸借区分, 科目c, 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細) SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行no, qry仕訳明細.科目c, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳no = qry仕訳見出.仕訳no ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳明細.行no) SELECT qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, tbl科目分類.貸借区分 AS 貸借区分, qry仕訳日記帳.仕訳日, qry仕訳日記帳.借方, qry仕訳日記帳.貸方, qry仕訳日記帳.見出摘要, qry仕訳日記帳.部門c, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no, qry仕訳日記帳.行摘要 FROM qry仕訳日記帳 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c) ON qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c ORDER BY qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, qry仕訳日記帳.仕訳日, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no), qry元帳前繰 as ( SELECT tbl期首残高.会計年月, tbl期首残高.科目c, tbl勘定科目.勘定科目名, tbl科目分類.貸借区分, substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日, tbl期首残高.前期繰越, case when (貸借区分='借方') then 前期繰越 else 0 end as 借方, case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方, '前期繰越' AS 摘要 FROM ( tbl期首残高 INNER JOIN tbl勘定科目 ON tbl期首残高.科目c = tbl勘定科目.勘定科目c) INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c) SELECT qry元帳前繰.会計年月, qry元帳前繰.科目c, qry元帳前繰.貸借区分, qry元帳前繰.仕訳日::timestamp with time zone, qry元帳前繰.借方, qry元帳前繰.貸方, qry元帳前繰.摘要::text, 0 AS 並順, '' AS 仕訳no, 0 AS 行no FROM qry元帳前繰 UNION SELECT qry元帳明細.会計年月, qry元帳明細.科目c, qry元帳明細.貸借区分, qry元帳明細.仕訳日, qry元帳明細.借方, qry元帳明細.貸方, qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要, 1 AS 並順, 仕訳no, 行no FROM qry元帳明細 ORDER BY 会計年月, 科目c, 仕訳日, 並順, 仕訳no, 行no;&quot; ;#EOL#}#EOL#if (reply == 2) {#EOL#&#x9;strSQL = &quot;with qry総勘定元帳 as (  with qry元帳明細 as (  with qry仕訳日記帳 as (  with qry仕訳見出 as (  SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月  FROM tbl仕訳見出 ) ,  qry仕訳明細 as (  SELECT  仕訳no,  行no,  貸借区分,  科目c,  仕訳額,  行摘要,  case when (貸借区分='借方') then 仕訳額 else 0 end as 借方,  case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方  FROM  tbl仕訳明細  )  SELECT  qry仕訳見出.会計年月,  qry仕訳見出.仕訳日,  qry仕訳見出.仕訳no,  qry仕訳見出.部門c,  qry仕訳見出.見出摘要,  qry仕訳明細.行no,  qry仕訳明細.科目c,  qry仕訳明細.借方,  qry仕訳明細.貸方,  qry仕訳明細.行摘要  FROM  qry仕訳明細  INNER JOIN  qry仕訳見出 ON  qry仕訳明細.仕訳no = qry仕訳見出.仕訳no  ORDER BY  qry仕訳見出.仕訳日,  qry仕訳見出.仕訳no,  qry仕訳明細.行no )  SELECT  qry仕訳日記帳.会計年月,  qry仕訳日記帳.科目c,  tbl科目分類.貸借区分 AS 貸借区分,  qry仕訳日記帳.仕訳日,  qry仕訳日記帳.借方,  qry仕訳日記帳.貸方,  qry仕訳日記帳.見出摘要,  qry仕訳日記帳.部門c,  qry仕訳日記帳.仕訳no,  qry仕訳日記帳.行no,  qry仕訳日記帳.行摘要  FROM  qry仕訳日記帳  INNER JOIN  (  tbl勘定科目  INNER JOIN  tbl科目分類 ON  tbl勘定科目.科目分類c = tbl科目分類.科目分類c  ) ON  qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c  ORDER BY  qry仕訳日記帳.会計年月,  qry仕訳日記帳.科目c,  qry仕訳日記帳.仕訳日,  qry仕訳日記帳.仕訳no,  qry仕訳日記帳.行no ) , qry元帳前繰 as ( SELECT  tbl期首残高.会計年月,  tbl期首残高.科目c,  tbl勘定科目.勘定科目名,  tbl科目分類.貸借区分,  substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日,  tbl期首残高.前期繰越,  case when (貸借区分='借方') then 前期繰越 else 0 end as 借方,  case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方,  前期繰越 AS 摘要  FROM  (  tbl期首残高  INNER JOIN  tbl勘定科目 ON  tbl期首残高.科目c = tbl勘定科目.勘定科目c  )  INNER JOIN  tbl科目分類 ON  tbl勘定科目.科目分類c = tbl科目分類.科目分類c  )  SELECT  qry元帳前繰.会計年月,  qry元帳前繰.科目c,  qry元帳前繰.貸借区分,  qry元帳前繰.仕訳日::timestamp with time zone,  qry元帳前繰.借方,  qry元帳前繰.貸方,  qry元帳前繰.摘要::text,  0 AS 並順,  '' AS 仕訳no,  0 AS 行no  FROM  qry元帳前繰  UNION  SELECT  qry元帳明細.会計年月,  qry元帳明細.科目c,  qry元帳明細.貸借区分,  qry元帳明細.仕訳日,  qry元帳明細.借方,  qry元帳明細.貸方,  qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要,  1 AS 並順,  仕訳no,  行no  FROM  qry元帳明細  ORDER BY  会計年月,  科目c,  仕訳日,  並順,  仕訳no,  行no )  SELECT  qry総勘定元帳.会計年月,  qry総勘定元帳.科目c,  tbl勘定科目.勘定科目名,  qry総勘定元帳.貸借区分,  SUM(qry総勘定元帳.借方) AS 借方合計,  SUM(qry総勘定元帳.貸方) AS 貸方合計,  sum(case when (貸借区分='借方') then qry総勘定元帳.借方-qry総勘定元帳.貸方 else 0 end) as 借方残高,  sum(case when (貸借区分='貸方') then qry総勘定元帳.貸方-qry総勘定元帳.借方 else 0 end) as 貸方残高  FROM  qry総勘定元帳  INNER JOIN  tbl勘定科目 ON  qry総勘定元帳.科目c = tbl勘定科目.勘定科目c  GROUP BY  qry総勘定元帳.会計年月,  qry総勘定元帳.科目c,  tbl勘定科目.勘定科目名,  qry総勘定元帳.貸借区分;&quot;;#EOL#}#EOL#if (reply == 3) {#EOL#&#x9;strSQL = &quot;with qry残高試算表 as ( with qry総勘定元帳 as ( with qry元帳明細 as ( with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出),qry仕訳明細 as ( SELECT 仕訳No, 行No, 貸借区分, 科目c, (select 勘定科目名 from tbl勘定科目 where 勘定科目c = 科目c), 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細)SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳No, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行No, qry仕訳明細.科目c, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳No = qry仕訳見出.仕訳No ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳No, qry仕訳明細.行No)SELECT qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, tbl科目分類.貸借区分 AS 貸借区分, qry仕訳日記帳.仕訳日, qry仕訳日記帳.借方, qry仕訳日記帳.貸方, qry仕訳日記帳.見出摘要, qry仕訳日記帳.部門c, qry仕訳日記帳.仕訳No, qry仕訳日記帳.行No, qry仕訳日記帳.行摘要 FROM qry仕訳日記帳 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c ORDER BY qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, qry仕訳日記帳.仕訳日, qry仕訳日記帳.仕訳No, qry仕訳日記帳.行No) , qry元帳前繰 as ( SELECT tbl期首残高.会計年月, tbl期首残高.科目c, tbl勘定科目.勘定科目名, tbl科目分類.貸借区分, substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日, tbl期首残高.前期繰越, case when (貸借区分='借方') then 前期繰越 else 0 end as 借方, case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方, 前期繰越 AS 摘要 FROM ( tbl期首残高 INNER JOIN tbl勘定科目 ON tbl期首残高.科目c = tbl勘定科目.勘定科目c ) INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c )SELECT qry元帳前繰.会計年月, qry元帳前繰.科目c, qry元帳前繰.貸借区分, qry元帳前繰.仕訳日::timestamp with time zone, qry元帳前繰.借方, qry元帳前繰.貸方, qry元帳前繰.摘要::text, 0 AS 並順, '' AS 仕訳No, 0 AS 行No FROM qry元帳前繰 UNION SELECT qry元帳明細.会計年月, qry元帳明細.科目c, qry元帳明細.貸借区分, qry元帳明細.仕訳日, qry元帳明細.借方, qry元帳明細.貸方, qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要, 1 AS 並順, 仕訳No, 行No FROM qry元帳明細 ORDER BY 会計年月, 科目c, 仕訳日, 並順, 仕訳No, 行No)SELECT qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分, SUM(qry総勘定元帳.借方) AS 借方合計, SUM(qry総勘定元帳.貸方) AS 貸方合計, sum(case when (貸借区分='借方') then qry総勘定元帳.借方-qry総勘定元帳.貸方 else 0 end) as 借方残高, sum(case when (貸借区分='貸方') then qry総勘定元帳.貸方-qry総勘定元帳.借方 else 0 end) as 貸方残高 FROM qry総勘定元帳 INNER JOIN tbl勘定科目 ON qry総勘定元帳.科目c = tbl勘定科目.勘定科目c GROUP BY qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分)SELECT qry残高試算表.*, tbl科目分類.bp区分, case when (bp区分='Ｂ／Ｓ') then 借方残高 else 0 end AS BS借方, case when (bp区分='Ｂ／Ｓ') then 貸方残高 else 0 end AS BS貸方, case when (bp区分='Ｐ／Ｌ') then 借方残高 else 0 end AS PL借方, case when (bp区分='Ｐ／Ｌ') then 貸方残高 else 0 end AS PL貸方 FROM qry残高試算表 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry残高試算表.科目c = tbl勘定科目.勘定科目c;&quot;;#EOL#}#EOL#if (reply == 4) {#EOL#&#x9;strSQL = &quot;with qry精算表 as ( with qry残高試算表 as ( with qry総勘定元帳 as ( with qry元帳明細 as ( with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出), qry仕訳明細 as ( SELECT 仕訳no, 行no, 貸借区分, 科目c, 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細) SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行no, qry仕訳明細.科目c, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳no = qry仕訳見出.仕訳no ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳明細.行no) SELECT qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, tbl科目分類.貸借区分 AS 貸借区分, qry仕訳日記帳.仕訳日, qry仕訳日記帳.借方, qry仕訳日記帳.貸方, qry仕訳日記帳.見出摘要, qry仕訳日記帳.部門c, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no, qry仕訳日記帳.行摘要 FROM qry仕訳日記帳 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c ORDER BY qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, qry仕訳日記帳.仕訳日, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no) , qry元帳前繰 as ( SELECT tbl期首残高.会計年月, tbl期首残高.科目c, tbl勘定科目.勘定科目名, tbl科目分類.貸借区分, substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日, tbl期首残高.前期繰越, case when (貸借区分='借方') then 前期繰越 else 0 end as 借方, case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方, 前期繰越 AS 摘要 FROM ( tbl期首残高 INNER JOIN tbl勘定科目 ON tbl期首残高.科目c = tbl勘定科目.勘定科目c ) INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) SELECT qry元帳前繰.会計年月, qry元帳前繰.科目c, qry元帳前繰.貸借区分, qry元帳前繰.仕訳日::timestamp with time zone, qry元帳前繰.借方, qry元帳前繰.貸方, qry元帳前繰.摘要::text, 0 AS 並順, '' AS 仕訳no, 0 AS 行no FROM qry元帳前繰 UNION SELECT qry元帳明細.会計年月, qry元帳明細.科目c, qry元帳明細.貸借区分, qry元帳明細.仕訳日, qry元帳明細.借方, qry元帳明細.貸方, qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要, 1 AS 並順, 仕訳no, 行no FROM qry元帳明細 ORDER BY 会計年月, 科目c, 仕訳日, 並順, 仕訳no, 行no) SELECT qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分, SUM(qry総勘定元帳.借方) AS 借方合計, SUM(qry総勘定元帳.貸方) AS 貸方合計, sum(case when (貸借区分='借方') then qry総勘定元帳.借方-qry総勘定元帳.貸方 else 0 end) as 借方残高, sum(case when (貸借区分='貸方') then qry総勘定元帳.貸方-qry総勘定元帳.借方 else 0 end) as 貸方残高 FROM qry総勘定元帳 INNER JOIN tbl勘定科目 ON qry総勘定元帳.科目c = tbl勘定科目.勘定科目c GROUP BY qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分) SELECT qry残高試算表.*, tbl科目分類.bp区分, case when (bp区分='Ｂ／Ｓ') then 借方残高 else 0 end AS BS借方, case when (bp区分='Ｂ／Ｓ') then 貸方残高 else 0 end AS BS貸方, case when (bp区分='Ｐ／Ｌ') then 借方残高 else 0 end AS PL借方, case when (bp区分='Ｐ／Ｌ') then 貸方残高 else 0 end AS PL貸方 FROM qry残高試算表 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry残高試算表.科目c = tbl勘定科目.勘定科目c) SELECT qry精算表.会計年月, qry精算表.科目c, qry精算表.勘定科目名, qry精算表.PL借方 AS 借方, qry精算表.PL貸方 AS 貸方 FROM qry精算表 WHERE (((qry精算表.bp区分)='Ｐ／Ｌ'));&quot;;#EOL#}#EOL#if (reply == 5) {#EOL#&#x9;strSQL = &quot;with qry精算表 as ( with qry残高試算表 as ( with qry総勘定元帳 as ( with qry元帳明細 as ( with qry仕訳日記帳 as ( with qry仕訳見出 as ( SELECT tbl仕訳見出.*, to_char(仕訳日,'yyyymm') AS 会計年月 FROM tbl仕訳見出), qry仕訳明細 as ( SELECT 仕訳no, 行no, 貸借区分, 科目c, 仕訳額, 行摘要, case when (貸借区分='借方') then 仕訳額 else 0 end as 借方, case when (貸借区分='貸方') then 仕訳額 else 0 end as 貸方 FROM tbl仕訳明細) SELECT qry仕訳見出.会計年月, qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳見出.部門c, qry仕訳見出.見出摘要, qry仕訳明細.行no, qry仕訳明細.科目c, qry仕訳明細.借方, qry仕訳明細.貸方, qry仕訳明細.行摘要 FROM qry仕訳明細 INNER JOIN qry仕訳見出 ON qry仕訳明細.仕訳no = qry仕訳見出.仕訳no ORDER BY qry仕訳見出.仕訳日, qry仕訳見出.仕訳no, qry仕訳明細.行no) SELECT qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, tbl科目分類.貸借区分 AS 貸借区分, qry仕訳日記帳.仕訳日, qry仕訳日記帳.借方, qry仕訳日記帳.貸方, qry仕訳日記帳.見出摘要, qry仕訳日記帳.部門c, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no, qry仕訳日記帳.行摘要 FROM qry仕訳日記帳 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry仕訳日記帳.科目c = tbl勘定科目.勘定科目c ORDER BY qry仕訳日記帳.会計年月, qry仕訳日記帳.科目c, qry仕訳日記帳.仕訳日, qry仕訳日記帳.仕訳no, qry仕訳日記帳.行no) , qry元帳前繰 as ( SELECT tbl期首残高.会計年月, tbl期首残高.科目c, tbl勘定科目.勘定科目名, tbl科目分類.貸借区分, substr(会計年月, 1, 4) || '-' || substr(会計年月, 5, 2) || '-' || '01' AS 仕訳日, tbl期首残高.前期繰越, case when (貸借区分='借方') then 前期繰越 else 0 end as 借方, case when (貸借区分='貸方') then 前期繰越 else 0 end as 貸方, 前期繰越 AS 摘要 FROM ( tbl期首残高 INNER JOIN tbl勘定科目 ON tbl期首残高.科目c = tbl勘定科目.勘定科目c ) INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) SELECT qry元帳前繰.会計年月, qry元帳前繰.科目c, qry元帳前繰.貸借区分, qry元帳前繰.仕訳日::timestamp with time zone, qry元帳前繰.借方, qry元帳前繰.貸方, qry元帳前繰.摘要::text, 0 AS 並順, '' AS 仕訳no, 0 AS 行no FROM qry元帳前繰 UNION SELECT qry元帳明細.会計年月, qry元帳明細.科目c, qry元帳明細.貸借区分, qry元帳明細.仕訳日, qry元帳明細.借方, qry元帳明細.貸方, qry元帳明細.見出摘要 || (case when qry元帳明細.行摘要 is null then '' else '(' || qry元帳明細.行摘要 || ')' end) AS 摘要, 1 AS 並順, 仕訳no, 行no FROM qry元帳明細 ORDER BY 会計年月, 科目c, 仕訳日, 並順, 仕訳no, 行no)SELECT qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分, SUM(qry総勘定元帳.借方) AS 借方合計, SUM(qry総勘定元帳.貸方) AS 貸方合計, sum(case when (貸借区分='借方') then qry総勘定元帳.借方-qry総勘定元帳.貸方 else 0 end) as 借方残高, sum(case when (貸借区分='貸方') then qry総勘定元帳.貸方-qry総勘定元帳.借方 else 0 end) as 貸方残高 FROM qry総勘定元帳 INNER JOIN tbl勘定科目 ON qry総勘定元帳.科目c = tbl勘定科目.勘定科目c GROUP BY qry総勘定元帳.会計年月, qry総勘定元帳.科目c, tbl勘定科目.勘定科目名, qry総勘定元帳.貸借区分)SELECT qry残高試算表.*, tbl科目分類.bp区分, case when (bp区分='Ｂ／Ｓ') then 借方残高 else 0 end AS BS借方, case when (bp区分='Ｂ／Ｓ') then 貸方残高 else 0 end AS BS貸方, case when (bp区分='Ｐ／Ｌ') then 借方残高 else 0 end AS PL借方, case when (bp区分='Ｐ／Ｌ') then 貸方残高 else 0 end AS PL貸方 FROM qry残高試算表 INNER JOIN ( tbl勘定科目 INNER JOIN tbl科目分類 ON tbl勘定科目.科目分類c = tbl科目分類.科目分類c ) ON qry残高試算表.科目c = tbl勘定科目.勘定科目c) SELECT qry精算表.会計年月, qry精算表.科目c, qry精算表.勘定科目名, qry精算表.BS借方 AS 借方, qry精算表.BS貸方 AS 貸方 FROM qry精算表 WHERE (((qry精算表.bp区分)='Ｂ／Ｓ'));&quot;;#EOL#}#EOL#if (reply >= 6 || reply == -1) {#EOL#&#x9;   instance.returnMap.put('RETURN_MESSAGE', '＊処理は取り消されました。');#EOL#}#EOL##EOL#if (strSQL.equals('') == false) {#EOL#&#x9;var obj = new JDBCSwingQuery(strSQL);#EOL#}#EOL#" SubsystemID="Y" Type="XF000"/><Function DetailKeyFields="" DetailTable="TBL仕訳明細" Direction="NORMAL" HeaderKeyFields="" HeaderTable="TBL仕訳見出" ID="rpt仕訳伝票" Margins="50;50;50;50" Name="rpt仕訳伝票" PageSize="A4" SubsystemID="Y" TableFontID="Font1" TableFontSize="9" TableRowNoWidth="5" Type="XF390" WithPageNumber="T"><HeaderPhrase Alignment="CENTER" Block="HEADER" FontID="Font1" FontSize="15" FontStyle="BOLD" MarginLeft="0" MarginRight="0" Order="0010" SpacingAfter="0" Value="&amp;Text(仕訳伝票)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0020" Value="&amp;DataSource(TBL仕訳見出.仕訳NO)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0030" Value="&amp;DataSource(TBL仕訳見出.仕訳日)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="0" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" Order="0040" Value="&amp;DataSource(TBL仕訳見出.部門C)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0060" SpacingAfter="0" Value="&amp;DataSource(TBL仕訳見出.見出摘要)"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.行NO" FieldOptions="" Order="0010" Width="12"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.貸借区分" FieldOptions="" Order="0020" Width="12"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.科目C" FieldOptions="" Order="0030" Width="12"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.仕訳額" FieldOptions="" Order="0050" Width="19"/><Column Alignment="LEFT" DataSource="TBL仕訳明細.行摘要" FieldOptions="" Order="0060" Width="19"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0080" SpacingAfter="-18" Value="&amp;Text(借方金額：) &amp;DataSource(TBL仕訳見出.借方金額)"/><HeaderPhrase Alignment="RIGHT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0090" SpacingAfter="0" Value="&amp;Text(貸方金額：) &amp;DataSource(TBL仕訳見出.貸方金額)"/><HeaderPhrase Alignment="LEFT" AlignmentMargin="" Block="PARAGRAPH" FontID="Font1" FontSize="12" FontStyle="" MarginLeft="0" MarginRight="0" Order="0050" SpacingAfter="0" Value="&amp;DataSource(TBL会計部門.部門名)"/><Column Alignment="LEFT" DataSource="TBL勘定科目.勘定科目名" FieldOptions="" Order="0040" Width="10"/></Function></System>